$.fn.table=function(e){let t,n,a=[],o="display_list",i=$(this).attr("id");const d=document.getElementById(i);e&&(e.columnDefs&&(t=e.columnDefs),e.table_type&&(o=e.table_type),e.data&&(a=e.data));const l=function(){let e=$("#"+i+"_wrapper .dataTables_filter"),t=$("#"+i+"_wrapper .dataTables_length"),n=$("#"+i+"_wrapper"),a=$("#"+i+"_wrapper select");$("#"+i).parent("div").removeClass("col-sm-12").addClass("p-0 m-0 w-100 h-100"),n.find("label").each(function(){$(this).parent().append($(this).children())}),n.find("div.row").removeClass("row").addClass("d-flex justify-content-between"),e.find("input").each(function(){const e=$(this);e.attr("placeholder","Search"),e.removeClass("form-control-sm")}),e.find("label").remove(),e.parent("div").removeClass("col-sm-12 col-md-6").addClass("w-50"),t.parent("div").removeClass("col-sm-12 col-md-6").addClass("w-50"),t.find("label").each(function(){$(this).addClass("mb-0 pb-0 mr-3 d-inline-block")}),a.removeClass("custom-select custom-select-sm form-control form-control-sm"),a.addClass("form-control d-inline-block"),"display_list"===o&&$("#"+i+">tbody>tr").css({cursor:"pointer"})},r=function(){try{let e=$("#"+i+"> tbody  > tr");$.each(e,function(e,t){$(t).removeClass("selected")})}catch(e){console.log("clear_selected_rows",e)}};if(d){try{n=$(this).DataTable({pageLength:5,lengthMenu:[[5,10,25,50,-1],[5,10,25,50,"All"]],data:a,columnDefs:t})}catch(e){console.log(e)}e.rowClick&&n.on("click","tr",function(){r(),$(this).addClass("selected");let t=n.row(this).data();e.rowClick(t)}),l()}return{insertRow:function(e){!function(e){if(e)try{n.row.add(e).node().id=i+"_tr_"+e.id,n.draw(!1),l()}catch(e){console.log(e)}}(e)},clearSelectedRows:function(){r()},update_row(e){!function(e){if(e)try{n.row(i+"_tr_"+e.id).data(e).draw(!1)}catch(e){console.log(e)}l()}(e)}}};const tableCellMaxChars=10,default_address_view="medium";let DEBUGMODE=!0;$.fn.BuildDropDown=function(e){if(!e||!e.text_field||!e.id_field)return;let t=document.getElementById($(this).attr("id")),n=e.data?e.data:[],a=(e.class_list&&e.class_list,e.id_field?e.id_field:""),o=e.text_field?e.text_field:"",i=e.title?e.title:"Select Option",d=!!e.first_selectable&&e.firstSelectable,l=!!e.select2&&e.select2,r=e.type?e.type:"";if($(t).empty(),"multiple"===r&&t.setAttribute("multiple","multiple"),!1===d){let e=$(document.createElement("option")).prop({value:"",text:"-- "+i.charAt(0).toUpperCase()+i.slice(1)+" --",disabled:!0}).attr("readonly","readonly");$(t).append(e)}$.each(n,function(e,n){let i=n[a],d=n[o];$(t).append($(document.createElement("option")).prop({value:i,text:d.charAt(0).toUpperCase()+d.slice(1)}))}),$(t).val(""),l&&$(t).select2()};const clear_validation=function(e){$(".autocomplete-suggestions").hide();var t=$(e).validate();$("[name]",e).each(function(){t.successList.push(this),t.showErrors()}),t.resetForm(),t.reset()},get_errors=function(e){},validator_init=function(e){let t={},n={},a={};return e&&(e.rules&&(t=e.rules),e.messages&&(n=e.messages),e.groups&&(a=e.groups)),jQuery.validator.setDefaults({rules:t,messages:n,groups:a,ignore:"",success:"valid",invalidHandler:function(e,t){let n=t.findLastActive()||t.errorList.length&&t.errorList[0].element;n&&$(n).closest(".accordion-body").collapse("show")},errorElement:"span",highlight:function(e){let t=$(e).attr("id"),n=$("#"+t),a=$("#"+t+"-error");a.attr("data-ref")?$("#"+a.attr("data-ref")).addClass("is-invalid"):(n.parent().find("span.select2").addClass("is-invalid"),n.addClass("is-invalid")),a&&a.css({display:"block"})},unhighlight:function(e){let t=$(e).attr("id"),n=$("#"+t),a=$("#"+t+"-error");n.parents("div.form-element").find("span.select2").removeClass("is-invalid"),n.removeClass("is-invalid"),a&&a.css({display:"none"})},errorPlacement:function(e,t){let n=t.attr("id");$("#"+n+"-error").html(e)},submitHandler:function(e){return!0}}),jQuery.validator.addMethod("postalCode",function(e){return/^((\d{5}-\d{4})|(\d{5})|([A-Z]\d[A-Z]\s\d[A-Z]\d))$/.test(e)},"Please enter a valid postal code."),jQuery.validator.addMethod("phoneUS",function(e,t){return e=e.replace(/\s+/g,""),this.optional(t)||e.length>9&&e.match(/^(\+?1-?)?(\([2-9]\d{2}\)|[2-9]\d{2})-?[2-9]\d{2}-?\d{4}$/)},"Please specify a valid phone number"),jQuery.validator.addMethod("phoneIT",function(e,t){return e=e.replace(/\s+/g,""),this.optional(t)||e.length>9&&e.match(/^(\+?1-?)?(\([2-9]\d{2}\)|[2-9]\d{2})-?[2-9]\d{2}-?\d{4}$/)},"Please specify a valid phone number"),jQuery.validator},remove_nulls=function(e){let t={};return $.each(e,function(e,n){null===n||(t[e]=n)}),t},buildMap=function(e,t){let n=new Map;return $.each(e,function(e,a){n.set(a[t],a)}),n},getListOfIds=function(e){if(e){if("string"==typeof e){let t=e.replace(/\s/g,"");return Array.from(t.split(","),Number)}if("object"==typeof e)return e}return[]},sendGetRequest=function(e,t,n){let a=[];if(!e||!t){let n=[];return e||n.push("url"),t||n.push("data_to_send"),handleError("Missing Data: "+n.join(", "))}$.getJSONRequest(e,t,function(e,t,o){return"success"===t&&void 0!==e.result?(a=e.result,n(a)):"failed"===t&&void 0===e.error?handleError("failed"):"success"===t&&void 0!==e.error?(console.log(e.error),handleError(e.error)):void 0})},sendPostRequest=function(e,t,n){let a=[];if(!e||!t)return e||(void 0).push("url"),t||(void 0).push("data_to_send"),handleError("Missing Data: "+(void 0).join(", "));$.postJSON(e,t,function(e,t,o){return"success"===t&&void 0!==e.result&&e.result?(a=e.result,n(a)):handleError("Error Posting Data")})},_display_ajax_error=function(e,t,n){let a="",o={message:"",status:"",uri:n};return a=0===e.status?"Not connected, verify Network.":404===e.status?"Requested page( "+n+" ) not found. [404]":500===e.status?"Internal Server Error [500].":"parsererror"===t?"Requested JSON parse failed.":"timeout"===t?"Time out error.":"abort"===t?"Ajax request aborted.":"Uncaught Error."+e.responseText,o.message=a,o.status=e.status,o.uri=n,o},handleError=function(e){e||(e="Error processing request"),toastr.error(e)},validInt=function(e){return e&&!isNaN(parseInt(e))?parseInt(e):null},formatDateMySQL=function(e){if(!e){new Date}return moment(e).format("YYYY-MM-DD HH:mm:ss")},resize_elements=function(){const e=document.getElementsByClassName("page"),t=document.getElementsByClassName("double-nav"),n=document.getElementById("screen_width"),a=document.getElementById("screen_height"),o=document.getElementsByClassName("page-footer"),i=document.getElementById("slide-out");let d=0,l=0,r=0,c=0,s=0,u=0,_=0,m=0;d=window.innerHeight,l=window.innerWidth,$.each(t,function(e,t){let n=isNaN(parseInt($(t).outerHeight()))?0:parseInt($(t).outerHeight());s+=n}),$.each(o,function(e,t){let n=isNaN(parseInt($(t).outerHeight()))?0:parseInt($(t).outerHeight());m+=n}),l>=1440&&i&&(_=isNaN(parseInt($(i).outerHeight()))?0:parseInt($(i).outerHeight()),u=isNaN(parseInt($(i).width()))?0:parseInt($(i).width())),n&&(r=isNaN(parseInt($(e).outerHeight()))?0:parseInt($(e).outerHeight()),c=isNaN(parseInt($(e).outerWidth()))?0:parseInt($(e).outerWidth()),$("main").css({"padding-left":u+"px","min-height":d-m-s+"px"}),$(e).css({"margin-top":s+"px",height:"auto"}),a.innerText=d,n.innerText=l)},debounce=function(e){var t;return function(n){t&&clearTimeout(t),t=setTimeout(e,100,n)}};jQuery.extend({postJSON:function(e,t,n){let a=$.ajax({url:e,type:"POST",data:t,dataType:"json"});return a.done(function(e){if($.isFunction(n))return n(e,"success"),!0}),a.fail(function(t,a,o){return console.log("Request failed"),console.log(_display_ajax_error(t,a,e)),$.isFunction(n)&&n(o,"failed"),!1}),a},getJSONRequest:function(e,t,n){let a=$.ajax({url:e,type:"GET",data:t,dataType:"json",async:!0});a.done(function(e){$.isFunction(n)&&n(e,"success")}),a.fail(function(t,a,o){if(void 0!==a){let n=_display_ajax_error(t,a,e);handleError(n.message),console.log(n)}else{let n=_display_ajax_error(t,a,e);handleError(n.message),console.log(n)}$.isFunction(n)&&n(o,"failed")})},getJSON:function(e,t,n){let a=$.ajax({url:e,type:"GET",data:t,dataType:"json",async:!1});a.done(function(e){$.isFunction(n)&&n(e,"success")}),a.fail(function(t,a,o){console.log("Request failed"),console.log(_display_ajax_error(t,a,e)),$.isFunction(n)&&n(o,"failed")})}});const populateMultiSelect=function(e,t){for(var n,a=0,o=t.options.length;a<o;a++)n=t.options[a],-1!==e.indexOf(n.value)&&(n.selected=!0)},addTinyMCE=function(e){tinymce.init({selector:"#"+e,menubar:!1,height:"400",plugins:"print visualblocks visualchars charmap hr pagebreak advlist lists",content_css:["https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300;0,400;0,600;0,700;0,800;1,300;1,400;1,600;1,700;1,800&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap","/assets/css/bootstrap.min.css","/assets/css/style.css"],body_class:"p-2",font_formats:"Andale Mono=andale mono,times; Arial=arial,helvetica,sans-serif; Arial Black=arial black,avant garde; Book Antiqua=book antiqua,palatino; Comic Sans MS=comic sans ms,sans-serif; Courier New=courier new,courier; Georgia=georgia,palatino; Helvetica=helvetica; Impact=impact,chicago; Open Sans=Open Sans; Roboto=Roboto;Symbol=symbol; Tahoma=tahoma,arial,helvetica,sans-serif; Terminal=terminal,monaco; Times New Roman=times new roman,times; Trebuchet MS=trebuchet ms,geneva; Verdana=verdana,geneva; Webdings=webdings; Wingdings=wingdings,zapf dingbats",toolbar1:"undo redo | styleselect | fontselect fontsizeselect | removeformat | numlist bullist checklist | outdent indent ",toolbar2:"cut copy | bold italic underline strikethrough | forecolor | alignleft aligncenter alignright alignjustify | backcolor",content_style:'body { font-family:"Roboto",sans-serif", sans-serif; font-size:14px; font-weight: 400 }',style_formats:[{title:"Headers",items:[{title:"h1",block:"h1"},{title:"h2",block:"h2"},{title:"h3",block:"h3"},{title:"h4",block:"h4"},{title:"h5",block:"h5"},{title:"h6",block:"h6"}]},{title:"Blocks",items:[{title:"p",block:"p"},{title:"div",block:"div"},{title:"pre",block:"pre"}]},{title:"Containers",items:[{title:"section",block:"section",wrapper:!0,merge_siblings:!1},{title:"article",block:"article",wrapper:!0,merge_siblings:!1},{title:"blockquote",block:"blockquote",wrapper:!0},{title:"hgroup",block:"hgroup",wrapper:!0},{title:"aside",block:"aside",wrapper:!0},{title:"figure",block:"figure",wrapper:!0}]}],branding:!1,resize:!1,setup:function(e){e.on("change",function(){e.save()})}})},htmlDecode=function(e){return $("<textarea/>").html(e).text()},htmlEncode=function(e){return $("<textarea/>").text(e).html()};$("document").ready(function(){window.addEventListener("resize",debounce(function(e){resize_elements()})),window.addEventListener("load",debounce(function(e){resize_elements()})),document.querySelectorAll(".but_toggle").forEach(e=>e.addEventListener("click",t=>{if(e.dataset.texted){let t=e.dataset.texted,n=$("#"+t);tinyMCE.get(t)?(n.val(htmlDecode(n.val())),tinymce.remove("#"+t)):(n.val(htmlDecode(n.val())),addTinyMCE(t))}})),(new WOW).init(),$(this).scrollTop(0),toastr.options={closeButton:!0,debug:!1,newestOnTop:!0,progressBar:!1,positionClass:"md-toast-top-center",preventDuplicates:!0,onclick:null,showDuration:301,hideDuration:1e3,timeOut:5e3,extendedTimeOut:1e3,showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"},document.addEventListener("DOMContentLoaded",function(e){document.getElementById("mdb-preloader")&&$("#mdb-preloader").fadeOut(500)}),$("body").scrollTop(),$(".button-collapse").sideNav({edge:"left",closeOnClick:!1,breakpoint:1200,menuWidth:240,timeDurationOpen:500,timeDurationClose:500,timeDurationOverlayOpen:200,timeDurationOverlayClose:200,easingOpen:"easeInOutQuad",easingClose:"easeInOutQuad",showOverlay:!0,showCloseButton:!1,slim:!1,onOpen:null,onClose:null,mode:"over"}),$.fn.dataTableExt.afnFiltering.push(function(e,t,n){if("dates_table"===e.nTable.id){var a=document.getElementById("min").value,o=document.getElementById("max").value;a=a.substring(6,10)+a.substring(3,5)+a.substring(0,2),o=o.substring(6,10)+o.substring(3,5)+o.substring(0,2);var i=t[1].substring(6,10)+t[1].substring(3,5)+t[1].substring(0,2),d=t[1].substring(6,10)+t[1].substring(3,5)+t[1].substring(0,2);return""===a&&""===o||(a<=i&&""===o||(o>=d&&""===a||a<=i&&o>=d))}return!0}),"scrollRestoration"in history&&(history.scrollRestoration="manual"),$("#alert_box").hide(),window.scrollTo(0,0)}),Object.defineProperty(window,"__stack",{get:function(){var e=Error.prepareStackTrace;Error.prepareStackTrace=function(e,t){return t};var t=new Error;Error.captureStackTrace(t,arguments.callee);var n=t.stack;return Error.prepareStackTrace=e,n}}),Object.defineProperty(window,"__line",{get:function(){return __stack[1].getLineNumber()}}),Object.defineProperty(window,"__function",{get:function(){return __stack[1].getFunctionName()}}),Object.defineProperty(window,"__file",{get:function(){return __stack[1].getFileName()}}),Object.defineProperty(window,"__logLineDetails",{get:function(){return{columnNumber:__stack[1].getColumnNumber(),functionName:__stack[1].getFunctionName(),lineNumber:__stack[1].getLineNumber(),fileName:__stack[1].getFileName(),typeName:__stack[1].getTypeName(),isEval:__stack[1].isEval(),this:__stack[1].getThis()}}});const Logger=function(){"use strict";let e=null,t=null,n=null,a=!0,o=!1,i=!0,d=215,l=0,r=200,c=function(){let e=new Date,t="0"+e.getHours();t=t.substring(t.length-2);let n="0"+e.getMinutes();n=n.substring(n.length-2);let a="0"+e.getSeconds();return t+":"+n+":"+(a=a.substring(a.length-2))},s=function(){let e=new Date,t=""+e.getFullYear(),n="0"+(e.getMonth()+1);n=n.substring(n.length-2);let a="0"+e.getDate();return t+"-"+n+"-"+(a=a.substring(a.length-2))},u=function(){let e=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame||window.webkitRequestAnimationFrame;return e?function(t){return e(t)}:function(e){return setTimeout(e,16)}};return{init:function(){if(e)return!0;if(!(document&&document.createElement&&document.body&&document.body.appendChild))return!1;if(!(e=document.getElementById("loggerContainer"))){(e=document.createElement("div")).id="loggerContainer",e.setAttribute("style","width:100%;margin:0;padding:0;text-align:left;box-sizing:border-box;position:fixed;left:0;z-index:9999;bottom:"+-d+"px;"),(t=document.createElement("div")).id="loggerTab",t.appendChild(document.createTextNode("LOG")),t.setAttribute("style","width:40px;box-sizing:border-box;overflow:hidden;font:bold 10px verdana,helvetica,sans-serif;line-height:19px;color:#fff;position:absolute;left:20px;top:-20px;margin:0; padding:0;text-align:center;border:1px solid #aaa;border-bottom:none;background:rgba(0,0,0,0.8);border-top-right-radius:8px;border-top-left-radius:8px;"),t.onmouseover=function(){this.style.cursor="pointer",this.style.textShadow="0 0 1px #fff, 0 0 2px #0f0, 0 0 6px #0f0"},t.onmouseout=function(){this.style.cursor="auto",this.style.textShadow="none"},t.onclick=function(){Logger.toggle(),this.style.textShadow="none"},(n=document.createElement("div")).id="logger",n.setAttribute("style","font:12px monospace;height: "+d+"px;box-sizing:border-box;color:#fff;overflow-x:hidden;overflow-y:scroll;visibility:hidden;position:relative;bottom:0px;margin:0px;padding:5px;background:rgba(0,0,0,0.8);border-top:1px solid #aaa;");let a=document.createElement("span");a.style.color="#afa",a.style.fontWeight="bold";let o="===== Log Started at "+s()+", "+c()+", (Logger version 1.00) =====";a.appendChild(document.createTextNode(o)),n.appendChild(a),n.appendChild(document.createElement("br")),n.appendChild(document.createElement("br")),e.appendChild(t),e.appendChild(n),document.body.appendChild(e)}return!0},print:function(t,a,o,d){d||(d="debug");let l=typeof a;if(!i)return;if(t||(t=""),!e){if(!this.init())return}a||(a="");o.lineNumber;let r=!0;"object"===l?a=JSON.stringify(a,null,4):"undefined"===l?(a="undefined",r=!1):"function"===l?(a="function",r=!1):null===a&&(a="null",r=!1),a instanceof Array?a=this.arrayToString(a):"object"===l?a=`[${o.functionName}:${o.lineNumber}] [${d.toUpperCase()}] [${o.fileName}] "${t}" (object)\n ${a}`:"number"===l?a=`[${d.toUpperCase()}] "${t}" (number)\n ${a}`:"string"===l?a=`'${t}' (string) ${a}`:"boolean"===l?a=`'${t}' (bool) ${a}`:a+="";let u=a.split(/\r\n|\r|\n/);for(let e=0,t=u.length;e<t;++e){let t=document.createElement("div");t.setAttribute("style","color:#999;float:left;");let a="0";if(0===e){let e=document.createTextNode(s()+" "+c()+" ");t.appendChild(e),a="6.0em"}let o=document.createElement("div");o.setAttribute("style","word-wrap:break-word;margin-left:"+a+";"),r||(o.style.color="#afa");let i=u[e].replace(/ /g," "),d=document.createTextNode(i);o.appendChild(d);let l=document.createElement("div");l.setAttribute("style","clear:both;"),n.appendChild(t),n.appendChild(o),n.appendChild(l),n.scrollTop=n.scrollHeight}},trace:function(e,t,n){0===arguments.length?Logger.print(""):Logger.print(e,t,n,"trace")},debug:function(e,t,n){0===arguments.length?Logger.print(""):Logger.print(e,t,n,"debug")},info:function(e,t,n){0===arguments.length?Logger.print(""):Logger.print(e,t,n,"info")},warn:function(e,t,n){0===arguments.length?Logger.print(""):Logger.print(e,t,n,"info")},error:function(e,t,n){0===arguments.length?Logger.print(""):Logger.print(e,t,n,"info")},toggle:function(){o?this.close():this.open()},open:function(){if(!this.init())return;if(!a)return;if(o)return;n.style.visibility="visible",l=Date.now();let t=u();t(function n(){let a=Date.now()-l;if(a>=r)return e.style.bottom=0,void(o=!0);let i=Math.round(-d*(1-.5*(1-Math.cos(Math.PI*a/r))));e.style.bottom=i+"px";t(n)})},close:function(){if(!this.init())return;if(!a)return;if(!o)return;l=Date.now();let t=u();t(function a(){let i=Date.now()-l;if(i>=r)return e.style.bottom=-d+"px",n.style.visibility="hidden",void(o=!1);let c=Math.round(.5*-d*(1-Math.cos(Math.PI*i/r)));e.style.bottom=c+"px";t(a)})},show:function(){this.init()&&(e.style.display="block",a=!0)},hide:function(){this.init()&&(e.style.display="none",a=!1)},enable:function(){this.init()&&(i=!0,t.style.color="#fff",n.style.color="#fff")},disable:function(){this.init()&&(i=!1,t.style.color="#666",n.style.color="#666")},clear:function(){this.init()&&(n.innerHTML="")},arrayToString:function(e){let t="[";for(let n=0,a=e.length;n<a;++n)e[n]instanceof Array?t+=this.arrayToString(e[n]):t+=e[n],n<a-1&&(t+=", ");return t+="]"}}}(),Location=function(){"use strict";const e=document.getElementById("form_edit_location"),t=document.getElementById("form_location_details"),n=document.getElementById("location_types_id"),a=document.getElementById("location_name_filter"),o=document.getElementById("location_city_id"),i=document.getElementById("location_country_id"),d=document.getElementById("location_province_id"),l=document.getElementById("location_id"),r=document.getElementById("location_street"),c=document.getElementById("location_street2"),s=document.getElementById("location_zipcode"),u=document.getElementById("location_name"),_=document.getElementById("temp_location_id"),m=document.getElementById("button_close_location_edit"),p=document.getElementById("button_submit_form_edit_location"),y=document.getElementById("button_edit_location"),f=document.getElementById("button_add_location_edit");let v,g=!1,b="medium";const h={rules:{location_types_id:{required:!0,digits:!0},location_city_id:{required:!0,digits:!0},location_country_id:{required:!0,digits:!0},location_province_id:{required:!0,digits:!0},location_name:{required:!0}},messages:{location_types_id:{required:"field required",digits:"invalid"},location_city_id:{required:"field required",digits:"invalid"},location_country_id:{required:"field required",digits:"invalid"},location_province_id:{required:"field required",digits:"invalid"},location_id:{required:"field required",digits:"invalid"},location_name:{required:"field required"}}};let E=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;$(m).on("click",function(){B()}),$(f).on("click",function(){N(),k(),L()}),$(a).on("click",function(){$(this).select()}).on("change",function(){""===$(this).val()&&(N(),k(),L())}).on("search",function(){N(),k(),L()}),$("input[name='location_display']").on("change",function(){let e=$("input[name='location_display']:checked").val();b=e,I(),null!==Location.detail["location_"+e]&&(a.value=Location.detail["location_"+e])}),$(y).on("click",function(){""===l.value&&(N(),k(),L()),C()}),$(p).on("click",function(){Location.save()}),$(i).on("change",function(){g&&x()}),$(d).on("change",function(){g&&x()}),$(n).on("change",function(){g&&x()}),$(o).on("change",function(){g&&x()});const I=function(){$(a).autocomplete({serviceUrl:"/autocomplete/locations",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",params:{default_display:b},onSelect:function(t){Province.set_detail(t.data),Country.set_detail(t.data),City.set_detail(t.data),Location.set_detail(t.data),L(t.data),clear_validation(e)},onSearchComplete:function(e,t){}})},w=function(e){toastr.error(e)},C=function(){!function(){let e=document.getElementsByName("location_display");$.each(e,function(e,t){t.disabled=!0}),a.disabled=!0,y.disabled=!0}(),$(t).show()},B=function(){!function(){let e=document.getElementsByName("location_display");$.each(e,function(e,t){t.disabled=!1}),a.disabled=!1,y.disabled=!1}(),$(t).hide()},k=function(){g=!1,v.resetForm(),u.value="",a.value="",l.value="",n.value="",r.value="",c.value="",s.value="",i.value="",d.value="",o.value="",Province.set_detail(),Country.set_detail(),City.id=null,$(i).val("").trigger("change"),document.getElementById("location_display_medium").checked=!0},L=function(e){e&&(Province.set_detail(e),Country.set_detail(e),City.set_detail(e)),a.value=Location.detail.location,u.value=Location.detail.name,l.value=Location.detail.id,$(n).val(Location.detail.location_types_id).trigger("change"),r.value=Location.detail.street,c.value=Location.detail.street2,s.value=Location.detail.zipcode,$(i).val(Location.detail.country_id?Location.detail.country_id:"").trigger("change"),$(_).val(Location.detail.id).trigger("change")},x=function(){return $(e).valid()},N=function(e){let t={id:null,location_long:null,location_short:null,location_medium:null,location:null,city_id:null,province_id:null,country_id:null,location_types_id:null,created_by:null,modified_by:null,name:null,street:null,street2:null,zipcode:null,enabled:null,date_created:null,date_modified:null,note:null};e&&(t.location_long=e.location_long?e.location_long:null,t.location_medium=e.location_medium?e.location_medium:null,t.location_short=e.location_short?e.location_short:null,t.location=e.location?e.location:null,t.id=e.location_id?e.location_id:null,t.city_id=e.location_city_id?e.location_city_id:null,t.province_id=e.location_province_id?e.location_province_id:null,t.country_id=e.location_country_id?e.location_country_id:null,t.location_types_id=e.location_types_id?e.location_types_id:null,t.created_by=e.location_created_by?e.location_created_by:null,t.modified_by=e.location_modified_by?e.location_modified_by:null,t.name=e.location_name?e.location_name:null,t.street=e.location_street?e.location_street:null,t.street2=e.location_street2?e.location_street2:null,t.zipcode=e.location_zipcode?e.location_zipcode:null,t.enabled=e.location_enabled?e.location_enabled:null,t.date_created=e.location_date_created?e.location_date_created:null,t.date_modified=e.location_date_modified?e.location_date_modified:null,t.note=e.location_note?e.location_note:null,Province.set_detail(e),Country.set_detail(e),City.set_detail(e)),Location.detail=t},M=function(){g=!0;let e={id:isNaN(parseInt(l.value))?null:parseInt(l.value),city_id:isNaN(parseInt(o.value))?null:parseInt(o.value),province_id:isNaN(parseInt(d.value))?null:parseInt(d.value),country_id:isNaN(parseInt(d.value))?null:parseInt(i.value),location_types_id:isNaN(parseInt(n.value))?null:parseInt(n.value),name:u&&""!==u.value?u.value:null,street:r&&""!==r.value?r.value:null,street2:c&&""!==c.value?c.value:null,zipcode:s&&""!==s.value?s.value:null,created_by:isNaN(parseInt(l.value))?E:null,modified_by:E,enabled:1,date_created:isNaN(parseInt(l.value))?formatDateMySQL():null,date_modified:isNaN(parseInt(l.value))?null:formatDateMySQL(),note:null};if(x()){!0===confirm("Are you sure you want to edit this record?")&&function(e){if(!e)return w("Error: Loading Location - Missing Data");try{sendPostRequest("/locations/update",e,function(e,t,n){if(!e)return w("Error: 1");e.location_id&&(l.value=e.location_id,g=!1,Province.set_detail(e),Country.set_detail(e),City.set_detail(e),Location.set_detail(e),L(e),B(),toastr.success("Location: "+e.location_id+" created"))})}catch(e){return console.log(e),w("Error: Validating Location")}}(remove_nulls(e))}};return{detail:{id:null,city_id:null,province_id:null,country_id:null,location_types_id:null,created_by:null,modified_by:null,name:null,street:null,street2:null,zipcode:null,enabled:null,date_created:null,date_modified:null,note:null},all:[],types:[],types_detail:{id:null,created_by:null,modified_by:null,name:null,icon:null,enabled:null,date_created:null,date_modified:null,note:null},save:function(){M()},set:function(e){!function(e){N(e),k(),L(e)}(e)},set_detail(e){N(e)},init:function(t){!function(t){validator_init(h),v=$(e).validate(),t&&t.types.location_types&&(Location.types=buildMap(t.types.location_types,"location_types_id")),e&&($(n).BuildDropDown({data:Array.from(Location.types.values()),title:"Location Types",id_field:"location_types_id",text_field:"location_types_name",first_selectable:!1}),$(i).BuildDropDown({data:Array.from(Country.all.values()),title:"Country",id_field:"country_id",text_field:"country_name",first_selectable:!1}),$(d).BuildDropDown({data:Array.from(Province.all.values()),title:"Province",id_field:"province_id",text_field:"province_name",first_selectable:!1}),$(o).BuildDropDown({data:Array.from(Province.all.values()),title:"City",id_field:"city_id",text_field:"city_name",first_selectable:!1}),Country.init({dropdowns:["location_country_id"]}),Province.init({dropdowns:["location_province_id"]}),City.init({dropdowns:["location_city_id"]})),I(),B()}(t)}}}(),Product=function(){"use strict";const e=document.getElementById("category_id"),t=document.getElementById("product_id"),n=document.getElementById("product_name"),a=document.getElementById("product_sku"),o=document.getElementById("product_rating_id"),i=document.getElementById("pricing_strategy_id"),d=document.getElementById("currency_id"),l=document.getElementById("product_description_short"),r=document.getElementById("product_description_long"),c=document.getElementById("view_all"),s=document.getElementById("view_sales"),u=document.getElementById("view_ops"),_=document.getElementById("view_management"),m=document.getElementById("table_product_index"),p=(document.getElementById("product_edit_form"),document.getElementById("product_edit"),document.getElementById("product_unit_edit_form"),document.getElementById("product_vendor_edit_form"),document.getElementById("product_type_sort"),document.getElementById("tab_product_edit_season")),y=document.getElementById("tab_product_edit_unit"),f=document.getElementById("tab_product_edit_variant"),v=document.getElementById("tab_product_edit_inventory"),g=document.getElementById("tab_product_edit_pricing");let b=$(m),h=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;const E=function(){""===t.value?($(p).addClass("disabled"),$(y).addClass("disabled"),$(f).addClass("disabled"),$(v).addClass("disabled"),$(g).addClass("disabled")):($(p).removeClass("disabled"),$(y).removeClass("disabled"),$(f).removeClass("disabled"))},I=function(m){m||(m={}),m=function(e){let t={};return e&&$.each(e,function(e,n){let a=e.replace("product_product_","");a=a.replace("product_",""),t[a]=n}),t}(m),Product.detail={api_id:m.api_id?m.api_id:null,arrive_time:m.arrive_time?m.arrive_time:null,arrive_to:m.arrive_to?m.arrive_to:null,category_id:m.category_id?m.category_id:null,child:m.child?m.child:null,city_id:m.city_id?m.city_id:null,cover_image:m.cover_image?m.cover_image:"/assets/img/placeholder.jpg",created_by:m.created_by?m.created_by:h,currency_id:m.currency_id?m.currency_id:null,date_created:m.date_created?m.date_created:formatDateMySQL(),date_modified:m.date_modified?m.date_modified:formatDateMySQL(),day_span:m.day_span?m.day_span:null,depart_from:m.depart_from?m.depart_from:null,depart_time:m.depart_time?m.depart_time:null,description_long:m.description_long?m.description_long:null,description_short:m.description_short?m.description_short:null,enabled:m.enabled?m.enabled:null,from_api:m.from_api?m.from_api:null,hotel_code:m.hotel_code?m.hotel_code:null,id:m.id?m.id:null,infant:m.infant?m.infant:null,location_id:m.location_id?m.location_id:null,modified_by:m.modified_by?m.modified_by:h,name:m.name?m.name:null,phone:m.phone?m.phone:null,pricing_strategy_types_id:m.pricing_strategy_types_id?m.pricing_strategy_types_id:null,provider_id:m.provider_id?m.provider_id:null,provider_vendor_match:m.provider_vendor_match?m.provider_vendor_match:1,rating:m.rating?m.rating:null,sku:m.sku?m.sku:null,status_types_id:m.status_types_id?m.status_types_id:4,teen:m.teen?m.teen:null},w(),$(e).val(Product.detail.category_id).trigger("change"),$(t).val(Product.detail.id).trigger("change"),n.value=Product.detail.name,$(a).val(Product.detail.sku).trigger("change"),$(o).val(Product.detail.rating).trigger("change"),$(i).val(Product.detail.pricing_strategy_types_id).trigger("change"),$(d).val(Product.detail.currency_id).trigger("change"),$(l).val(Product.detail.description_short).trigger("change"),$(r).val(Product.detail.description_long).trigger("change"),c.checked=1===Product.detail.view_all,s.checked=1===Product.detail.view_sales,u.checked=1===Product.detail.view_ops,_.checked=1===Product.detail.view_management,console.log("Product.detail",Product.detail)},w=function(){e.value="",t.value="",n.value="",a.value="",o.value="",i.value="",d.value="",l.value="",r.value="",c.checked=!0,s.checked=!0,u.checked=!0,_.checked=!0},C=function(e){var t;console.log("settings",e),Product.all=new Map,e&&e.products_list&&(t=e.products_list,$.each(t,function(e,t){Product.all.set(t.product_id,t),console.log(t)}),console.log(Product.all)),m&&(b=$(m).table({table_type:"display_list",data:Array.from(Product.all.values()),columnDefs:[{title:"Id",targets:0,data:"product_id"},{title:"Category",targets:1,data:"category_name",render:function(e,t,n,a){return`<span class='' style='white-space: nowrap'>${e}</span>`}},{title:"Name",targets:2,data:"product_table_display",render:function(e,t,n,a){return`<span class='' style='white-space: nowrap'>${e}</span>`}},{title:"Provider",targets:3,data:"provider_name",render:function(e,t,n,a){return`<span class='' style='white-space: nowrap'>${e}</span>`}},{title:"Enabled",targets:4,data:"product_enabled",render:function(e,t,n,a){let o="<span class='text-primary' style='white-space: nowrap'>Enabled</span>";return 0!==e&&!1!==e||(o="<span class='text-danger' style='white-space: nowrap'>Disabled</span>"),o}}],rowClick:Product.navigate}))};return{detail:{api_id:null,arrive_time:null,arrive_to:null,category_id:null,child:null,city_id:null,cover_image:"/assets/img/placeholder.jpg",created_by:h,currency_id:null,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),day_span:null,depart_from:null,depart_time:null,description_long:null,description_short:null,enabled:null,from_api:null,hotel_code:null,id:null,infant:null,location_id:null,modified_by:h,name:null,phone:null,pricing_strategy_types_id:null,provider_id:null,provider_vendor_match:1,rating:null,sku:null,status_types_id:4,teen:null},types:new Map,all:new Map,navigate:function(e){var t;e.product_id&&e.product_id&&(t=e.product_id)&&(window.location.href=`/products/${t}`)},init_edit:function(e){!function(e){console.log("Product.init_edit",e),w(),e&&(e.product&&(I(e.product),e.product_seasons&&(Season.init_product_edit(e.product_seasons),$(p).removeClass("disabled"))),e.categories&&Category.load(e.categories)),E()}(e)},init_index:function(e){C(e)},set_autocomplete:function(e){!function(e){console.log("category_id",e),$(n).autocomplete({serviceUrl:"/autocomplete/products",minChars:2,noCache:!0,triggerSelectOnValidInput:!1,dataType:"json",paramName:"st",params:{categoryId:parseInt(e)},onSelect:function(e){console.log("suggestion",e.data)}})}(e)},init:function(){E()}}}();Product.init();const Unit=function(){"use strict";return{detail:{},all:new Map,init:function(e){}}}(),Pricing=function(){"use strict";return{detail:{},all:new Map,init:function(e){}}}(),Variant=function(){"use strict";return{detail:{},all:new Map,init:function(e){}}}(),Season=function(){"use strict";const e=document.getElementById("table_product_seasons"),t=(document.getElementById("select_season_assign_type"),document.getElementById("block_edit"),document.getElementById("show_titles"),document.getElementById("background_color")),n=document.getElementById("background_color_display"),a=document.getElementById("border_color"),o=document.getElementById("border_color_display"),i=document.getElementById("text_color"),d=document.getElementById("text_color_display"),l=(document.getElementById("button_edit_product_clear_season"),document.getElementById("season_name")),r=document.getElementById("season_id"),c=document.getElementById("button_edit_product_delete_selected"),s=document.getElementById("button_edit_product_new_season_toggle"),u=document.getElementById("enable_all_seasons"),_=document.getElementById("enable_season_sunday"),m=document.getElementById("enable_season_monday"),p=document.getElementById("enable_season_tuesday"),y=document.getElementById("enable_season_wednesday"),f=document.getElementById("enable_season_thursday"),v=document.getElementById("enable_season_friday"),g=document.getElementById("enable_season_saturday"),b=document.getElementById("season_enabled"),h=(document.getElementById("product_season_edit_form"),document.getElementById("calendar_season")),E=document.getElementById("category_id"),I=document.getElementById("button_product_edit_add_dates_to_season");let w=$(e),C=[],B=moment(moment().year()+"-01-01").format("YYYY-MM-DD"),k=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4,L=[$("#season_calendar_0"),$("#season_calendar_1"),$("#season_calendar_2"),$("#season_calendar_3"),$("#season_calendar_4"),$("#season_calendar_5"),$("#season_calendar_6"),$("#season_calendar_7"),$("#season_calendar_8"),$("#season_calendar_9"),$("#season_calendar_10"),$("#season_calendar_11"),$("#season_calendar_12"),$("#season_calendar_13"),$("#season_calendar_14"),$("#season_calendar_15"),$("#season_calendar_16"),$("#season_calendar_17"),$("#season_calendar_18"),$("#season_calendar_19"),$("#season_calendar_20"),$("#season_calendar_21"),$("#season_calendar_22"),$("#season_calendar_23"),$("#season_calendar_24"),$("#season_calendar_25"),$("#season_calendar_26"),$("#season_calendar_27"),$("#season_calendar_28"),$("#season_calendar_29"),$("#season_calendar_30"),$("#season_calendar_31"),$("#season_calendar_32"),$("#season_calendar_33"),$("#season_calendar_34"),$("#season_calendar_35")],x=[];$(s).on("click",function(){N(),w.clearSelectedRows()}),$(t).colorpicker({format:"hex",fallbackColor:"#fff",color:"#fff",colorSelectors:{grey:"#777",blue:"#337ab7",success:"#5cb85c",info:"#5bc0de",warning:"#f0ad4e",red:"#d9534f"}}).change(function(){let e=$(this).val();$(n).css("background",e)}),$(a).colorpicker({format:"hex",fallbackColor:"#999",color:"#999"}).change(function(){let e=$(this).val();$(o).css("background",e)}),$(i).colorpicker({format:"hex",fallbackColor:"#000",color:"#000"}).change(function(){let e=$(this).val();$(d).css("background",e)});const N=function(){$(t).val("#fff").trigger("change"),$(i).val("#000").trigger("change"),$(a).val("#999").trigger("change"),C=[],b.checked=!0,_.checked=!0,m.checked=!0,p.checked=!0,y.checked=!0,f.checked=!0,v.checked=!0,g.checked=!0,u.checked=!0,r.value="",l.value=""},M=function(){x=[];for(let e=0;e<L.length;e++)e<6&&(x.push(L[e]),L[e].show());return x},D=function(e){e||(e={}),e=function(e){let t={};return e&&$.each(e,function(e,n){let a=e.replace("product_season_","");a=a.replace("season_",""),t[a]=n}),t}(e),Season.detail={id:e.id?e.id:null,name:e.name?e.name:null,class:e.class?e.class:null,category_id:e.category_id?e.category_id:null,background_color:e.background_color?e.background_color:"#fff",text_color:e.text_color?e.text_color:"#000",border_color:e.border_color?e.border_color:"#999",view_product_index:e.view_product_index?e.view_product_index:1,view_product_index_filter:e.view_product_index_filter?e.view_product_index_filter:1,view_product_index_search:e.view_product_index_search?e.view_product_index_search:1,view_product_edit:e.view_product_edit?e.view_product_edit:1,view_product_package_edit:e.view_product_package_edit?e.view_product_package_edit:1,view_product_package_index:e.view_product_package_index?e.view_product_package_index:1,enabled:e.enabled?e.enabled:1,date_created:e.date_created?e.date_created:formatDateMySQL(),disabled_dow:e.disabled_dow?e.disabled_dow.replace(/\s+/g,"").split(","):[],created_by:e.created_by?e.created_by:k,date_modified:e.date_modified?e.date_modified:formatDateMySQL(),modified_by:e.modified_by?e.modified_by:k}},S=function(){$(l).on("click",function(){$(this).select()})},P=function(){let e=M(),t=moment(B).year()+" - "+moment(B).add(6,"months").year();console.log("active_calendars",e),console.log("display_range",t),$.each(e,function(e,t){t.fullCalendar({header:{left:"title",center:"",right:""}})})},q=function(n){N(),a&&$(a).val("#eee").trigger("change"),t&&$(t).val("#fff").trigger("change"),i&&$(i).val("#000").trigger("change"),I&&(I.disabled=!0),c&&$(c).hide(),c&&$(c).hide(),e&&e&&(w=$(e).table({table_type:"display_list",data:Array.from(Season.all.values()),columnDefs:[{title:"Id",targets:0,data:"id"},{title:"Name",targets:1,data:"name",render:function(e,t,n,a){return`<span class='' style='white-space: nowrap'>${e}</span>`}}],rowClick:Season.edit})),l&&E&&S(),h&&P()},A=function(e){e&&function(e){Season.all=new Map,e&&$.each(e,function(e,t){D(t),Season.all.set(Season.detail.id,Season.detail),w.insertRow(Season.detail)}),console.log("Season.all",Season.all),console.log("Season.detail",Season.detail)}(e)};return{all:new Map,types:new Map,types_detail:{},detail:{disabled_dow:[],id:null,name:null,class:null,category_id:null,background_color:null,text_color:null,border_color:null,view_product_index:1,view_product_index_filter:1,view_product_index_search:1,view_product_edit:1,view_product_package_edit:1,view_product_package_index:1,enabled:1,date_created:formatDateMySQL(),created_by:null,date_modified:formatDateMySQL(),modified_by:null},edit:function(e){!function(e){e&&(console.log("season",e),$(t).val(e.background_color).trigger("change"),$(a).val(e.border_color).trigger("change"),$(i).val(e.text_color).trigger("change"),l.value=e.name,r.value=e.id)}(e)},set_autocomplete:function(){S()},init_product_edit:function(e){A(e)},init:function(e){q()}}}();Season.init();const SeasonCalendar=function(){"use strict";document.getElementById("calendar_season"),document.getElementById("calendar_season_title"),document.getElementById("calendar_season_prev_year"),document.getElementById("calendar_season_next_year"),document.getElementById("button_calendar_season_clear_selected_dates"),document.getElementById("collapse_calendar_season_filter"),document.getElementById("calendar_season_view_count"),document.getElementById("calendar_season_block"),document.getElementById("season_calendar_0");return{init:function(){}}}(),Category=function(){"use strict";const e=document.getElementById("category_id"),t=document.getElementById("product_id"),n=document.getElementById("product_edit_form"),a=document.getElementById("product_rating_id"),o=document.getElementById("pricing_strategy_id"),i=document.getElementById("product_name");document.getElementById("depart_time"),document.getElementById("arrive_time"),document.getElementById("day_span");let d=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;$(e).on("change",function(){n&&(isNaN(parseInt($(this).val()))||(l(),Season.set_autocomplete(parseInt($(this).val())),Product.set_autocomplete(parseInt($(this).val()))))});const l=function(){!function(){let n=!isNaN(t.value);switch(console.log("new_product",n),e.value){case"1":n?(i.disabled=!1,o.value="",a.value=""):i.disabled=!0,a.disabled=!1;break;case"2":n?(i.disabled=!1,o.value="2",a.value=""):i.disabled=!0,a.disabled=!0;break;case"3":n?(i.disabled=!1,o.value="3",a.value=""):i.disabled=!0,a.disabled=!0;break;case"4":n?(i.disabled=!1,o.value="2",a.value=""):i.disabled=!0,a.disabled=!0;break;case"5":n?(i.disabled=!1,o.value="",a.value=""):i.disabled=!0,a.disabled=!1;break;case"6":n?(i.disabled=!1,o.value="2",a.value=""):i.disabled=!0,a.disabled=!0;break;case"7":case"8":n?(i.disabled=!1,o.value="",a.value=""):i.disabled=!0,a.disabled=!1;break;case"9":console.log("other"),n?(i.disabled=!1,o.value="",a.value=""):i.disabled=!0,a.disabled=!1;break;default:i.disabled=!0,n&&(o.value="",a.value=""),a.disabled=!1}}(),isNaN(parseInt(e.value))},r=function(e){e||(e={}),e=function(e,t){let n={};return e&&$.each(e,function(e,t){let a=e.replace("category_","");n[a]=t}),n}(e),Category.detail={all_day:e.all_day?e.all_day:1,background_color:e.background_color?e.background_color:"#fff",border_color:e.border_color?e.border_color:"#999",created_by:e.created_by?e.created_by:d,date_created:e.date_created?e.date_created:formatDateMySQL(),date_modified:e.date_modified?e.date_modified:formatDateMySQL(),display:e.display?e.display:"",duration_editable:e.duration_editable?e.duration_editable:1,editable:e.editable?e.editable:1,enabled:e.enabled?e.enabled:1,icon:e.icon?e.icon:"",id:e.id?e.id:null,modified_by:e.modified_by?e.modified_by:d,name:e.name?e.name:"",overlap:e.overlap?e.overlap:1,pricing_strategy_types_id:e.pricing_strategy_types_id?e.pricing_strategy_types_id:null,start_editable:e.start_editable?e.start_editable:1,text_color:e.text_color?e.text_color:"#000",view_product_edit:e.view_product_edit?e.view_product_edit:1,view_product_index:e.view_product_index?e.view_product_index:1,view_product_index_filter:e.view_product_index_filter?e.view_product_index_filter:1,view_product_index_search:e.view_product_index_search?e.view_product_index_search:1,view_product_package_edit:e.view_product_package_edit?e.view_product_package_edit:1}};return{detail:{},all:new Map,init:function(){l()},load:function(e){!function(e){Category.all=new Map,e&&$.each(e,function(e,t){r(t),Category.all.set(Category.detail.id,Category.detail)}),console.log("Category.all",Category.all)}(e)}}}();Category.init();const City=function(){"use strict";let e=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;const t=function(e){toastr.error(e),console.log(e)},n=e=>{$(e.target).parents("form.form-new-city")[0]||e.target.className.includes("select-add-option")||City.close()},a=function(e,n,a){City.all=new Map;let o="";if(null!==City.id&&(o=City.id),a)if(e&&n&&a){!function(e,n){if(!e)return t("Error Loading Province- Missing Data");try{sendGetRequest("/cities/get",e,function(e,a,o){return e?n(e):t("Oops: 1")})}catch(e){return console.log(e),t("Error Validating Province")}}({country_id:parseInt(e),province_id:parseInt(n)},function(e){e&&(City.all=buildMap(e,"city_id"),$(a).BuildDropDown({data:Array.from(City.all.values()),title:"City",id_field:"city_id",text_field:"city_name",first_selectable:!1}),$(a).val(o).trigger("change"))})}else $(a).BuildDropDown({data:Array.from(City.all.values()),title:"City",id_field:"city_id",text_field:"city_name",first_selectable:!1})},o=function(e,t,a){e&&function(e,t,a){let o=$(e).attr("id"),i=$(e).parents("div.row"),d="";if(t&&(d=t),!o||!i[0])return;if(document.getElementById("form_new_city"))return;let l=document.createElement("form"),r=document.createElement("h5"),c=document.createElement("div"),s=document.createElement("div"),u=document.createElement("div"),_=document.createElement("div"),m=document.createElement("div"),p=document.createElement("div"),y=document.createElement("div"),f=document.createElement("div"),v=document.createElement("div"),g=document.createElement("div"),b=document.createElement("div"),h=document.createElement("div"),E=document.createElement("input"),I=document.createElement("label"),w=document.createElement("button"),C=document.createElement("button");r.classList="card-title",r.innerText="City Details",l.id="form_new_city",l.classList=["card card-body m-3 form-new-city"],E.id="city_name",E.name="city_name",E.type="text",E.classList=["form-control "],I.htmlFor="city_name",I.innerHTML="Name:",h.id="city_name-error",w.classList=["btn btn-primary btn-sm waves-effect waves-light"],w.innerText="save",w.type="button",w.addEventListener("click",t=>{City.save(e,a)}),C.classList=["btn btn-outline-danger btn-sm waves-effect waves-light"],C.innerText="cancel",C.type="button",C.addEventListener("click",e=>{City.close()}),c.classList=["row"],s.classList=["row"],u.classList=["col-lg-3 mb-1"],_.classList=["col-lg-3 mb-1"],m.classList=["col-lg-3 mb-1"],p.classList=["col-lg-3 mb-1"],y.classList=["col-12 mb-1 text-right"],f.classList=["form-element"],v.classList=["form-element"],g.classList=["form-element"],b.classList=["form-element"],h.classList=["error w-100 text-center"],f.appendChild(I),f.appendChild(E),f.appendChild(h),u.appendChild(f),c.appendChild(u),c.appendChild(_),c.appendChild(m),c.appendChild(p),y.append(C),y.appendChild(w),s.appendChild(y),l.appendChild(r),l.appendChild(c),l.appendChild(s),i[0].appendChild(l),E.value=d,E.focus({preventScroll:!1}),window.addEventListener("click",n)}(e,t,a)},i=function(e,n){let a={},o=document.getElementById("city_name"),i=document.getElementById(n.replace(/city_id/g,"")+"province_id"),d=document.getElementById(n.replace(/city_id/g,"")+"country_id");if(!isNaN(parseInt(d.value))&&!isNaN(parseInt(i.value))&&d){a.name=o.value,a.country_id=parseInt(d.value),a.province_id=parseInt(i.value),!0===confirm("Are you sure you want to edit this record?")&&function(e,n){if(n)try{sendPostRequest("/cities/update",n,function(n,a,o){if(!n||!n[0])return t("Error: 1");{City.all.set(n[0].city_id,n[0]);let t=$("select[data-type='city']");console.log(t.length),City.id=n[0].city_id,t.each(function(e,t){var a=new Option(n[0].city_name,n[0].city_id,!1,!1);$(t).append(a).trigger("change")}),$(e).val(n[0].city_id).trigger("change"),City.close(),toastr.success("City: "+n[0].city_id+" updated")}})}catch(e){console.log(e),t("Error: Validating City")}else console.log("Error: Missing Data"),t("Error: Missing Data")}(e,remove_nulls(a))}},d=function(e){!function(e){e&&e.dropdowns&&$.each(e.dropdowns,function(e,t){let n=document.getElementById(t);n&&$(n).select2({language:{searching:function(){}},escapeMarkup:function(e){return e}}).on("select2:open",function(e){let a=document.querySelectorAll("[aria-controls='select2-"+t+"-results']");if(a[0]){let e=a[0];if($(e).attr("id",t+"_search"),!document.getElementById("filter_city_add_icon")){let a=document.createElement("i");a.classList="select-add-option fas fa-plus filter_city_add",a.id="filter_city_add_icon",a.addEventListener("click",a=>{let o=e.value;$(n).select2("close"),City.add(this,o,t)}),e.after(a)}$(".filter_city_add").hide(),e&&e.addEventListener("keyup",t=>{""!==e.value?$(".filter_city_add").show():$(".filter_city_add").hide()})}}).on("change",function(){let e=$(this).attr("id").replace("city","city");document.getElementById(e),isNaN(parseInt($(this).val()))||(City.id=$(this).val())})})}(e)};return{id:null,detail:{id:null,province_id:null,country_id:null,created_by:null,modified_by:null,sort_order:null,name:null,enabled:null,date_created:null,date_modified:null,note:null},all:[],close:function(){!function(){let e=document.getElementById("form_new_city");e&&(e.parentNode.removeChild(e),window.removeEventListener("click",n))}()},save:function(e,t){i(e,t)},get:function(e,t,n){a(e,t,n)},add:function(e,t,n){o(e,t,n)},set_detail:function(t){!function(t){let n={id:null,province_id:null,country_id:null,created_by:null,modified_by:null,sort_order:null,name:null,enabled:null,date_created:null,date_modified:null,note:null},a=null;t&&(n={id:a=validInt(t.city_id),province_id:validInt(t.city_province_id),country_id:validInt(t.city_country_id),created_by:t.city_created_by?t.city_created_by:e,modified_by:t.city_created_by?t.city_created_by:e,sort_order:t.city_sort_order?t.city_sort_order:null,name:t.city_name?t.city_name:null,enabled:t.city_enabled?t.city_enabled:1,date_created:t.city_date_created?t.city_date_created:formatDateMySQL(),date_modified:t.city_date_modified?t.city_date_modified:formatDateMySQL(),note:t.city_note?t.city_note:null}),City.id=a,City.detail=n}(t)},init:function(e){d(e)}}}(),Country=function(){"use strict";const e="form_new_country";let t=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;const n={rules:{country_name:{required:!0},country_iso2:{minlength:2},country_iso3:{minlength:3}},messages:{country_name:{required:"required"},country_iso2:{minlength:"too short"},country_iso3:{minlength:"too short"}}},a=function(e){toastr.error(e),console.log(e)},o=e=>{$(e.target).parents("form.form-new-country")[0]||e.target.className.includes("select-add-option")||Country.close()},i=function(e){e&&e.dropdowns&&$.each(e.dropdowns,function(e,t){let n=document.getElementById(t);n&&$(n).select2({language:{searching:function(){}},escapeMarkup:function(e){return e}}).on("select2:open",function(e){let a=document.querySelectorAll("[aria-controls='select2-"+t+"-results']");if(a[0]){let e=a[0];if($(e).attr("id",t+"_search"),!document.getElementById("filter_country_add_icon")){let t=document.createElement("i");t.classList="select-add-option fas fa-plus filter_country_add",t.id="filter_country_add_icon",t.addEventListener("click",t=>{let a=e.value;$(n).select2("close"),Country.add(this,a)}),e.after(t)}$(".filter_country_add").hide(),e&&e.addEventListener("keyup",t=>{""!==e.value?$(".filter_country_add").show():$(".filter_country_add").hide()})}}).on("update",function(){console.log("ss")}).on("change",function(){let e=$(this).attr("id").replace("country","province"),t=$(this).attr("id").replace("country","city"),n=document.getElementById(e),a=document.getElementById(t);isNaN(parseInt($(this).val()))?Province.get(null,n):n&&(Province.get(parseInt($(this).val()),n),City.get(null,null,a))})})},d=function(){return{id:null,name:null,sort_order:null,iso2:null,iso3:null,currency_id:null,enabled:1,note:null,created_by:t,modified_by:t,date_created:formatDateMySQL(),date_modified:formatDateMySQL()}},l=function(e){!function(e,t){if(!e)return a("Error Loading Country- Missing Data");try{sendGetRequest("/countries/get",e,function(e,n,o){return console.log(e),e?t(e):a("Oops: 1")})}catch(e){return console.log(e),a("Error Validating Country")}}({},function(t){t&&(Country.all=t,i(e))})},r=function(t,n){t&&function(t,n){let a=$(t).attr("id"),i=$(t).parents("div.row"),d="";if(n&&(d=n),!a||!i[0])return;if(document.getElementById(e))return;let l=document.createElement("form"),r=document.createElement("h5"),c=document.createElement("div"),s=document.createElement("div"),u=document.createElement("div"),_=document.createElement("div"),m=document.createElement("div"),p=document.createElement("div"),y=document.createElement("div"),f=document.createElement("div"),v=document.createElement("div"),g=document.createElement("div"),b=document.createElement("div"),h=document.createElement("div"),E=document.createElement("div"),I=document.createElement("div"),w=document.createElement("input"),C=document.createElement("label"),B=document.createElement("input"),k=document.createElement("label"),L=document.createElement("input"),x=document.createElement("label"),N=document.createElement("button"),M=document.createElement("button");r.classList="card-title",r.innerText="Country Details",l.id=e,l.classList=["card card-body m-3 form-new-country"],w.id="country_name",w.name="country_name",w.type="text",w.classList=["form-control "],C.htmlFor="country_name",C.innerHTML="Name:",h.id="country_name-error",B.id="country_iso2",B.name="country_iso2",B.type="text",B.maxLength=2,B.classList=["form-control "],k.htmlFor="country_iso2",k.innerHTML="ISO2:",E.id="country_iso2-error",L.id="country_iso3",L.name="country_iso3",L.type="text",L.maxLength=3,L.classList=["form-control "],x.htmlFor="country_iso3",x.innerHTML="ISO3:",I.id="country_iso3-error",N.classList=["btn btn-primary btn-sm waves-effect waves-light"],N.innerText="save",N.type="button",N.addEventListener("click",e=>{Country.save(t)}),M.classList=["btn btn-outline-danger btn-sm waves-effect waves-light"],M.innerText="cancel",M.type="button",M.addEventListener("click",e=>{Country.close()}),c.classList=["row"],s.classList=["row"],u.classList=["col-lg-3 mb-1"],_.classList=["col-lg-3 mb-1"],m.classList=["col-lg-3 mb-1"],p.classList=["col-lg-3 mb-1"],y.classList=["col-12 mb-1 text-right"],f.classList=["form-element"],v.classList=["form-element"],g.classList=["form-element"],b.classList=["form-element"],h.classList=["error w-100 text-center"],E.classList=["error w-100 text-center"],I.classList=["error w-100 text-center"],f.appendChild(C),f.appendChild(w),f.appendChild(h),u.appendChild(f),v.appendChild(k),v.appendChild(B),v.appendChild(E),_.appendChild(v),g.appendChild(x),g.appendChild(L),g.appendChild(I),m.appendChild(g),c.appendChild(u),c.appendChild(_),c.appendChild(m),c.appendChild(p),y.append(M),y.appendChild(N),s.appendChild(y),l.appendChild(r),l.appendChild(c),l.appendChild(s),i[0].appendChild(l),w.value=d,w.focus({preventScroll:!1}),window.addEventListener("click",o)}(t,n)},c=function(t){let o=document.getElementById("country_name"),i=document.getElementById("country_iso2"),d=document.getElementById("country_iso3");if(o&&i&&d)if(function(){let t=document.getElementById("country_name"),a=document.getElementById("country_iso2"),o=document.getElementById("country_iso3");return!!(t&&a&&o)&&(validator_init(n),$("#"+e).validate(),$("#"+e).valid())}()){let e={};e.name=""!==o.value?o.value:null,e.iso2=""!==i.value?i.value:null,e.iso3=""!==d.value?d.value:null,!0===confirm("Are you sure you want to edit this record?")&&function(e,t){if(t)try{sendPostRequest("/countries/update",t,function(t,n,o){if(!t)return a("Error: 1");Country.all.push(t),$("select[data-type='country']").each(function(e,n){var a=new Option(t.country_name,t.country_id,!1,!1);$(n).append(a).trigger("change")}),$(e).val(t.country_id).trigger("change"),Country.close(),toastr.success("Country: "+t.country_id+" updated")})}catch(e){console.log(e),a("Error: Validating Province")}else console.log("Error: Missing Data"),a("Error: Missing Data")}(t,remove_nulls(e))}else toastr.error("Error: 1");else toastr.error("Error: 2")};return{detail:{},all:[],close:function(){!function(){let t=document.getElementById(e);t&&(t.parentNode.removeChild(t),window.removeEventListener("click",o))}()},add:function(e,t){r(e,t)},save:function(e){c(e)},set:function(e){console.log("-- set --")},set_detail:function(e){!function(e){let n=d(),a=null;e&&(a=validInt(e.country_id),n={id:validInt(e.country_id),name:e.country_name?e.country_name:null,sort_order:e.country_sort_order?e.country_sort_order:null,iso2:e.country_iso2?e.country_iso2:null,iso3:e.country_iso3?e.country_iso3:null,currency_id:validInt(e.country_currency_id),enabled:e.country_enabled?e.country_enabled:1,date_created:e.country_date_created?e.country_date_created:formatDateMySQL(),created_by:e.country_created_by?e.country_created_by:t,date_modified:e.country_date_modified?e.country_date_modified:formatDateMySQL(),modified_by:e.country_modified_by?e.country_modified_by:t,note:e.country_note?e.country_note:null}),Country.id=a,Country.detail=n}(e)},get:function(e){l(e)},init:function(e){!function(e){i(e)}(e)}}}(),Province=function(){"use strict";const e="form_new_province";let t=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;const n=function(e){toastr.error(e),console.log(e)},a=e=>{$(e.target).parents("form.form-new-province")[0]||e.target.className.includes("select-add-option")||Province.close()},o=function(){return{id:null,name:null,sort_order:null,iso2:null,iso3:null,enabled:1,note:null,created_by:t,modified_by:t,date_created:formatDateMySQL(),date_modified:formatDateMySQL()}},i=function(){let t=document.getElementById(e);t&&(t.parentNode.removeChild(t),window.removeEventListener("click",a))},d=function(e,t){Province.all=new Map;let a="";if(null!==Province.id&&(a=Province.id),!t||!e)return $(t).BuildDropDown({data:Array.from(Province.all.values()),title:"Province",id_field:"province_id",text_field:"province_name",first_selectable:!1}),void $(t).val("").trigger("change");!function(e,t){if(!e)return n("Error Loading Province- Missing Data");try{sendGetRequest("/provinces/get",e,function(e,a,o){return e?t(e):n("Oops: 1")})}catch(e){return console.log(e),n("Error Validating Province")}}({country_id:e},function(e){e&&(Province.all=buildMap(e,"province_id"),$(t).BuildDropDown({data:Array.from(Province.all.values()),title:"Province",id_field:"province_id",text_field:"province_name",first_selectable:!1}),$(t).val(a).trigger("change"))})},l=function(t,n,o){t&&function(t,n,o){let d=$(t).attr("id"),l=$(t).parents("div.row"),r="";if(n&&(r=n),!d||!l[0])return;if(document.getElementById(e))return;let c=document.createElement("form"),s=document.createElement("h5"),u=document.createElement("div"),_=document.createElement("div"),m=document.createElement("div"),p=document.createElement("div"),y=document.createElement("div"),f=document.createElement("div"),v=document.createElement("div"),g=document.createElement("div"),b=document.createElement("div"),h=document.createElement("div"),E=document.createElement("div"),I=document.createElement("div"),w=document.createElement("div"),C=document.createElement("div"),B=document.createElement("input"),k=document.createElement("label"),L=document.createElement("input"),x=document.createElement("label"),N=document.createElement("input"),M=document.createElement("label"),D=document.createElement("button"),S=document.createElement("button");c.id=e,c.classList=["card card-body m-3 form-new-province"],s.classList="card-title",s.innerText="Province Details",B.id="province_name",B.name="province_name",B.type="text",B.classList=["form-control"],k.htmlFor="province_name",k.innerHTML="Name:",I.id="province_name-error",L.id="province_iso2",L.name="province_iso2",L.type="text",L.maxLength=2,L.classList=["form-control"],x.htmlFor="province_iso2",x.innerHTML="ISO2:",w.id="province_iso2-error",N.id="province_iso3",N.name="province_iso3",N.type="text",N.maxLength=3,N.classList=["form-control"],M.htmlFor="province_iso3",M.innerHTML="ISO3:",C.id="province_iso3-error",D.classList=["btn btn-primary btn-sm waves-effect waves-light"],D.innerText="save",D.type="button",D.addEventListener("click",e=>{Province.save(t,o)}),S.classList=["btn btn-outline-danger btn-sm waves-effect waves-light"],S.innerText="cancel",S.type="button",S.addEventListener("click",e=>{i()}),u.classList=["row"],_.classList=["row"],m.classList=["col-lg-3 mb-1"],p.classList=["col-lg-3 mb-1"],y.classList=["col-lg-3 mb-1"],f.classList=["col-lg-3 mb-1"],v.classList=["col-12 mb-1 text-right"],g.classList=["form-element"],b.classList=["form-element"],h.classList=["form-element"],E.classList=["form-element"],I.classList=["error w-100 text-center"],w.classList=["error w-100 text-center"],C.classList=["error w-100 text-center"],g.appendChild(k),g.appendChild(B),g.appendChild(I),m.appendChild(g),b.appendChild(x),b.appendChild(L),b.appendChild(w),p.appendChild(b),h.appendChild(M),h.appendChild(N),h.appendChild(C),y.appendChild(h),u.appendChild(m),u.appendChild(p),u.appendChild(y),u.appendChild(f),v.append(S),v.appendChild(D),_.appendChild(v),c.appendChild(s),c.appendChild(u),c.appendChild(_),l[0].appendChild(c),B.value=r,B.focus({preventScroll:!1}),window.addEventListener("click",a)}(t,n,o)},r=function(e,t){let a={},o=document.getElementById("province_name"),i=document.getElementById("province_iso2"),d=document.getElementById("province_iso3"),l=document.getElementById(t.replace(/province_id/g,"")+"country_id");if(!isNaN(parseInt(l.value))&&l){a.name=o.value,a.iso2=i.value,a.iso3=d.value,a.country_id=parseInt(l.value),!0===confirm("Are you sure you want to edit this record?")&&function(e,t){if(t)try{sendPostRequest("/provinces/update",t,function(t,a,o){if(!t||!t[0])return n("Error: 1");{Province.all.set(t[0].province_id,t[0]);let n=$("select[data-type='province']");Province.id=t[0].province_id,City.id=null,n.each(function(e,n){var a=new Option(t[0].province_name,t[0].province_id,!1,!1);$(n).append(a).trigger("change")}),$(e).val(t[0].province_id).trigger("change"),Province.close(),toastr.success("Province: "+t[0].province_id+" updated")}})}catch(e){console.log(e),n("Error: Validating Province")}else console.log("Error: Missing Data"),n("Error: Missing Data")}(e,remove_nulls(a))}},c=function(e){!function(e){e&&e.dropdowns&&$.each(e.dropdowns,function(e,t){let n=document.getElementById(t);n&&$(n).select2({language:{searching:function(){}},escapeMarkup:function(e){return e}}).on("select2:open",function(e){let a=document.querySelectorAll("[aria-controls='select2-"+t+"-results']");if(a[0]){let e=a[0];if($(e).attr("id",t+"_search"),!document.getElementById("filter_province_add_icon")){let a=document.createElement("i");a.classList="select-add-option fas fa-plus filter_province_add",a.id="filter_province_add_icon",a.addEventListener("click",a=>{let o=e.value;$(n).select2("close"),Province.add(this,o,t)}),e.after(a)}$(".filter_province_add").hide(),e&&e.addEventListener("keyup",t=>{""!==e.value?$(".filter_province_add").show():$(".filter_province_add").hide()})}}).on("change",function(){let e=$(this).attr("id").replace("province","city"),t=$(this).attr("id").replace("province","country"),n=document.getElementById(e),a=document.getElementById(t);if(n&&a)if(isNaN(parseInt(a.value)))City.id=null,City.get(null,null,n);else{let e=parseInt(a.value);isNaN(parseInt($(this).val()))?(City.id=null,City.get(e,null,n)):City.get(e,parseInt($(this).val()),n)}City.id=null,Province.id=null})})}(e)};return{detail:{},all:[],id:null,set_detail:function(e){!function(e){let n=o(),a=null;e&&(a=validInt(e.province_id),n={id:validInt(e.province_id),name:e.province_name?e.province_name:null,sort_order:e.province_sort_order?e.province_sort_order:null,country_id:validInt(e.province_country_id),iso2:e.province_iso2?e.province_iso2:null,iso3:e.province_iso3?e.province_iso3:null,enabled:e.province_enabled?e.province_enabled:1,date_created:e.province_date_created?e.province_date_created:formatDateMySQL(),created_by:e.province_created_by?e.province_created_by:t,date_modified:e.province_date_modified?e.province_date_modified:formatDateMySQL(),modified_by:e.province_modified_by?e.province_modified_by:t,note:e.province_note?e.province_note:null}),Province.id=a,Province.detail=n}(e)},update_select:function(e,t){},close:function(){i()},save:function(e,t){r(e,t)},get:function(e,t){d(e,t)},add:function(e,t,n){l(e,t,n)},init:function(e){c(e)}}}();$("a.panel-action").on("click",function(){if($(this).data("toggle")){switch($(this).data("toggle")){case"panel-fullscreen":Panel.go_fullscreen($(this))}}else Panel.compress_all()});const Panel=function(){"use strict";return{go_fullscreen:function(e){!function(e){e&&(e.hasClass("fa-expand")?function(e){e.removeClass("fa-expand"),e.addClass("fa-compress"),e.closest("section.panel").addClass("is-fullscreen")}(e):e.hasClass("fa-compress")&&function(e){e.removeClass("fa-compress"),e.addClass("fa-expand"),e.closest("section.panel").removeClass("is-fullscreen")}(e))}(e)},compress_all:function(){$(".is-fullscreen").each(function(){$(this).removeClass("is-fullscreen")}),$("a.panel-action.fas.fa-compress").each(function(){$(this).removeClass("fa-compress").addClass("fa-expand")})},init:function(e){}}}(),Provider=function(){"use strict";let e=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;const t=document.getElementById("provider_index"),n=document.getElementById("provider_edit"),a=document.getElementById("provider_name"),o=document.getElementById("provider_id"),i=document.getElementById("provider_company_id");let d,l;$.fn.providerIndex=function(e){const t=document.getElementById("table_provider_index");let n=$(t);e&&e.provider_list&&(Provider.all=e.provider_list),t&&(n=$(t).table({table_type:"display_list",data:Provider.all,columnDefs:[{title:"Id",targets:0,data:"provider_id"},{title:"Name",targets:1,data:"company_name",render:function(e,t,n,a){let o="";return e?(o=e,"display"===t&&e.length>10?"<span style='white-space: nowrap'>"+o.substr(0,7)+"</span></span>":"<span style='white-space: nowrap'>"+o+"</span></span>"):""}},{title:"Location",targets:2,data:"location",render:function(e,t,n,a){return e}}],rowClick:Provider.navigate}))},$.fn.providerEdit=function(t){const n=document.getElementById("provider_vender_details"),a=document.getElementById("form_edit_provider"),o=document.getElementById("provider_id"),i=document.getElementById("provider_code_direct_id"),d=document.getElementById("provider_enabled"),l=document.getElementById("company_name"),r=document.getElementById("company_id"),c=document.getElementById("provider_location_id"),s=document.getElementById("button_submit_form_edit_provider"),u=document.getElementById("button_add_provider_address"),_=document.getElementById("button_add_provider_contact"),m=document.getElementById("button_provider_add_contact"),p=document.getElementById("button_provider_add_address"),y=document.getElementById("provider_vendor"),f=document.getElementById("temp_location_id"),v=$("[aria-controls='panel_tab_contacts']"),g=$("[aria-controls='panel_tab_addresses']"),b=$("[aria-controls='panel_tab_vendor_detail']");let h={rules:{provider_location_id:{required:!0},provider_code_direct_id:{required:!0}},messages:{provider_location_id:{required:"Field Required"},provider_code_direct_id:{required:"Field Required"}}};$(s).on("click",function(){Provider.save()}),$(p).on("click",function(){""!==provider_id.value&&Address.load_modal()}),$(u).on("click",function(){""!==provider_id.value&&Address.load_modal()}),$(m).on("click",function(){o&&""===o.value||Contact.edit()}),$(_).on("click",function(){o&&""===o.value||Contact.edit()}),$(f).on("change",function(){c.value=f.value}),$(y).on("change",function(){!0===y.checked?C():w()});const E=function(t){let n=I();t&&(n={id:validInt(t.provider_id),company_id:validInt(t.provider_company_id),location_id:validInt(t.provider_location_id),code_direct_id:t.provider_code_direct_id?t.provider_code_direct_id:null,provider_vendor:t.provider_provider_vendor?t.provider_provider_vendor:1,enabled:t.provider_enabled?t.provider_enabled:null,note:t.provider_note?t.provider_note:null,created_by:t.provider_created_by?parseInt(t.provider_created_by):e,modified_by:t.provider_modified_by?parseInt(t.provider_modified_by):e,date_created:t.provider_date_created?t.provider_date_created:formatDateMySQL(),date_modified:t.provider_date_modified?t.provider_date_modified:formatDateMySQL(),addresses:t.provider_addresses?t.provider_addresses:[],contacts:t.provider_contacts?t.provider_contacts:[]}),Provider.detail=n},I=function(){return{id:null,company_id:null,location_id:null,code_direct_id:null,provider_vendor:1,enabled:1,note:null,addresses:new Map,contacts:new Map,created_by:e,modified_by:e,date_created:formatDateMySQL(),date_modified:formatDateMySQL()}},w=function(){B(),$(n).hide(),b.addClass("disabled")},C=function(){B(),b.removeClass("disabled"),$(n).show()},B=function(){},k=function(e){toastr.error(e)},L=function(e){e&&(Vendor.clear_provider_vendor_form(),e.provider_detail?(E(e.provider_detail),Vendor.init(e.provider_detail),Company.init(e.provider_detail),Provider.detail.contacts&&Contact.load(Provider.detail.contacts),Provider.detail.addresses&&Address.load(Provider.detail.addresses),Location.set(e.provider_detail),Vendor.populate_provider_vendor_form()):(y.checked=!0,y.disabled=!1,$(n).show(),Company.init(),Vendor.init(),Vendor.clear_provider_vendor_form()),o.value=Provider.detail.id,y.checked=1===Provider.detail.provider_vendor,d.checked=!!Provider.detail.enabled&&1===Provider.detail.enabled,i.value=Provider.detail.code_direct_id,r.value=Company.detail.id,l.value=Company.detail.name,$(y).trigger("change")),$(".autocomplete-suggestions").hide()},x=function(){let t=Array.from(Address.all.values()),n=Array.from(Contact.all.values()),a=Company.validate_form(),l=Provider.validate_form(),r=Vendor.validate_form();$.each(t,function(e,t){let n=t.id;$.each(t.address_types_id,function(e,t){console.log({address_id:n,address_types_id:t})})}),$.each(n,function(e,t){let n=t.id;$.each(t.contact_types_id,function(e,t){console.log({contact_id:n,contact_types_id:t})})});let c={id:isNaN(parseInt(o.value))?null:parseInt(o.value),company_id:isNaN(parseInt(Company.detail.id))?null:parseInt(Company.detail.id),location_id:isNaN(parseInt(Location.detail.id))?null:parseInt(Location.detail.id),provider_vendor:!0===y.checked?1:0,code_direct_id:""!==i.value?i.value:null,enabled:!0===d.checked?1:0,created_by:isNaN(parseInt(o.value))?e:null,date_created:isNaN(parseInt(o.value))?formatDateMySQL():null,modified_by:e,date_modified:formatDateMySQL(),note:null,company_contacts:n,company_addresses:t};a?l?!0!==y.checked||r?!0===confirm("Are you sure you want to edit this record?")&&function(e){if(!e)return k("Error: 3");try{sendPostRequest("/providers/update",e,function(e,t,n){if(!e)return k("Error: 1");console.log("data",e),o&&""===o.value&&history.replaceState({},"",e.provider_detail.provider_id),y.checked&&Vendor.save_provider_vendor(e.provider_detail),Provider.load(e)})}catch(e){return console.log(e),k("Error: 2")}}(remove_nulls(c)):console.log("provider: vendor_data","Missing"):console.log("provider: provider_data","Missing"):console.log("provider: company_data","Missing")},N=function(e){n&&$(n).hide(),Contact.build_company_contact_table(),Address.build_company_address_table(),o.value="",i.value="",d.value="",d.checked=!0,c.value="",$(l).attr("readonly",!1),E(),e.types&&(e.countries&&(Country.all=e.countries),Address.init(e),Location.init(e),Contact.init(e)),L(e),Provider.validator=validator_init(h),e.provider_detail?(v.removeClass("disabled"),g.removeClass("disabled")):(v.addClass("disabled"),g.addClass("disabled"))};return{address_view:function(e){},contact_view:function(e){},save:function(){x()},validate_form:function(){return function(){Provider.validator=validator_init(h);var e=$("#provider_edit_tabs>div.panel-heading.panel-heading-tab>ul.nav.nav-tabs>li.nav-item>a.nav-link"),t=$("#provider_edit_tabs > div.panel-body > div.tab-content > div.tab-pane");let n=$(a).valid();return n||$.each(t,function(n,a){if($(this).find(".invalid").length>0){let n=$("body").find("[aria-controls='"+$(this).attr("id")+"']");return e.removeClass("active"),t.removeClass("active"),$(this).addClass("active"),n.addClass("active"),!1}}),n}()},set_detail:function(e){E(e)},load:function(e){L(e)},init:function(e){N(e)}}};let r=!1;const c=function(){a&&($(a).on("change",function(){}).autocomplete({serviceUrl:"/autocomplete/provider",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){console.log("suggestion",e.data),r=!0,i.value=e.data.company_id,o.value=e.data.provider_id,a.value=e.data.company_name}}),console.log("init"))};return{validator:null,detail:{id:null,company_id:null,location_id:null,code_direct_id:null,provider_vender:1,enabled:null,note:null,created_by:e,modified_by:e,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),addresses:[],contacts:[]},all:[],index_table:null,save:function(){n&&(console.log("-- _provider_edit --"),l.save())},load:function(e){l.load(e)},contact_view:function(e){l.contact_view(e)},address_view:function(e){l.address_view(e)},validate_form:function(){return l.validate_form()},navigate:function(e){!function(e){e&&e.provider_id&&window.location.replace("/providers/"+e.provider_id)}(e)},index:function(e){t&&(d=$(t).providerIndex(e))},edit:function(e){n&&(l=$(n).providerEdit()).init(e)},init:function(){c()}}}();Provider.init();const Address=function(){"use strict";const e=document.getElementById("table_provider_addresses"),t=document.getElementById("table_company_addresses"),n=document.getElementById("modal_address"),a=document.getElementById("modal_button_submit_edit_address"),o=document.getElementById("modal_button_cancel_edit_address"),i=document.getElementById("address_types_list"),d=document.getElementById("form_address_edit"),l=document.getElementById("address_id"),r=document.getElementById("address_street"),c=document.getElementById("address_street2"),s=document.getElementById("address_street3"),u=document.getElementById("address_city_id"),_=document.getElementById("address_postal_code"),m=document.getElementById("address_province_id"),p=document.getElementById("address_country_id"),y=document.getElementById("address_enabled"),f={rules:{address_types_list:"required",address_country_id:"required",address_province_id:"required",address_city_id:"required"},messages:{address_types_list:"Address type is required",address_country_id:"Country type is required",address_province_id:"Province is required",address_city_id:"City type is required"}};let v,g,b=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;$(a).on("click",function(){k()}),$(o).on("click",function(){D()}),$(n).on("shown.bs.modal",function(){let e=$(n);$(p).select2({dropdownParent:e}),$(m).select2({dropdownParent:e}),$(u).select2({dropdownParent:e})});const h=function(e){let t="<p>",n="<p>",a=0;return("string"==typeof e||e instanceof String)&&(e=e.split(",")),$.each(e,function(e,o){let i=Address.types.get(o),d="";(a+1)%2==0&&(d="</br>");let l="";a>0&&(l=", "),i&&(n+="<span class='m-1' style='white-space: nowrap'>"+i.address_types_name+l+"</span>"+d,t+=l+i.address_types_name+""),a++}),t+="</p>",n+="</p>"},E=function(e,t){let n=e.postal_code?e.postal_code:"",a=e.street_1?e.street_1:"",o=(e.street_2&&e.street_2,e.street_3&&e.street_3,e.city_name?e.city_name:""),i=(e.country_iso2&&e.country_iso2,e.country_iso3&&e.country_iso3,e.country_name?e.country_name:""),d=e.province_iso2?e.province_iso2:"",l=(e.province_iso3&&e.province_iso3,e.province_name&&e.province_name,'<address class="mb-0">'),r='<address class="mb-0">',c='<address class="mb-0">',s=[];""!==a&&s.push(a),l+=s.join("</br>"),r+=s.join("</br>"),c+=s.join("</br>");let u=[];return""!==o&&u.push("<span class=''>"+o.toUpperCase()+"</span>"),""!==d&&u.push("<span class=''>"+d.toUpperCase()+"</span>"),""!==n&&u.push("<span class=''>"+n+"</span>"),r+="</br>"+u.join(" "),""!==i&&(l+="</br>"+i.toUpperCase(),r+="</br>"+i.toUpperCase(),c+="</br>"+i.toUpperCase()),l+="</address>",c+="</address>",r+="</address>"},I=function(e){toastr.error(e)},w=function(e){if(!e)return console.log("Error: 3"),I("Error: 3");try{sendPostRequest("/addresses/update",e,function(n,a,o){if(!n||!n[0])return console.log("Error: 1"),I("Error: 1");{let a=n[0],o=C(n[0]);e.id?function(e){e.id&&e.id;e.address_id&&e.address_id;$(t).DataTable().row("#table_company_addresses_tr_"+e.id).data(e).draw(!1)}(o):g.insertRow(o),Address.all.set(Address.detail.id,Address.detail),toastr.success("Contact: "+a.address_id+" updated"),D()}})}catch(e){return console.log(e),I("Error: 2")}},C=function(e){let t=B();return e&&(t={formatted_types:h(getListOfIds(e.address_types_id)),formatted_address:E(e),city_id:validInt(e.address_city_id),country_id:validInt(e.address_country_id),id:validInt(e.address_id),postal_code:e.address_postal_code?e.address_postal_code:null,province_id:validInt(e.address_province_id),street_1:e.address_street_1?e.address_street_1:null,street_2:e.address_street_2?e.address_street_2:null,street_3:e.address_street_3?e.address_street_3:null,address_types_id:e.address_types_id?getListOfIds(e.address_types_id):[],city_name:e.city_name?e.city_name:null,country_iso2:e.country_iso2?e.country_iso2:null,country_iso3:e.country_iso3?e.country_iso3:null,country_name:e.country_name?e.country_name:null,province_iso2:e.province_iso2?e.province_iso2:null,province_iso3:e.province_iso3?e.province_iso3:null,province_name:e.province_name?e.province_name:null,enabled:e.address_enabled?e.address_enabled:1,created_by:e.address_created_by?e.address_created_by:b,modified_by:e.address_modified_by?e.address_modified_by:b,date_created:e.address_date_created?e.address_date_created:formatDateMySQL(),date_modified:e.address_date_modified?e.address_date_modified:formatDateMySQL(),note:e.address_note?e.address_note:null}),Address.detail=t,t},B=function(){return{formatted_address:"",formatted_types:"",city_id:null,country_id:null,id:null,postal_code:null,province_id:null,street_1:null,street_2:null,street_3:null,address_types_id:[],city_name:null,country_iso2:null,country_iso3:null,country_name:null,provider_id:null,province_iso2:null,province_iso3:null,province_name:null,enabled:1,note:null,created_by:b,modified_by:b,date_created:formatDateMySQL(),date_modified:formatDateMySQL()}},k=function(){if(!M())return;let e=Address.all.get(parseInt(l.value));e?e.id=isNaN(parseInt(l.value))?null:parseInt(l.value):e={note:null,date_created:formatDateMySQL(),created_by:b},e.modified_by=b,document.getElementById("company_id")&&""!==document.getElementById("company_id").value&&!isNaN(parseInt(document.getElementById("company_id").value))&&(e.company_id=parseInt(document.getElementById("company_id").value)),e.date_modified=formatDateMySQL(),e.address_types_id=getListOfIds($(i).val().join(",")),e.enabled=y.checked?1:0,e.street_1=""!==r.value?r.value:null,e.street_2=""!==c.value?c.value:null,e.street_3=""!==s.value?s.value:null,e.postal_code=""!==_.value?_.value:null,e.city_id=validInt(u.value),e.province_id=validInt(m.value),e.country_id=validInt(p.value),!0===confirm("Are you sure you want to edit this record?")&&w(remove_nulls(e))},L=function(e){x(),N(e),n&&$(n).modal("show")},x=function(){l.value="",$(i).val([]),y.checked=!0,r.value="",c.value="",s.value="",p.value="",m.value="",u.value="",_.value=""},N=function(e){e?(l.value=e.id?e.id:null,$(i).val(e.address_types_id?e.address_types_id:[]),y.checked=1===e.enabled,r.value=e.street_1?e.street_1:null,c.value=e.street_2?e.street_2:null,s.value=e.street_3?e.street_3:null,Province.id=e.province_id?e.province_id:null,Country.id=e.country_id?e.country_id:null,City.id=e.city_id?e.city_id:null,$(p).val(Address.detail.country_id?Address.detail.country_id:"").trigger("change"),_.value=Address.detail.postal_code?Address.detail.postal_code:null):(Province.get(null,m),Country.id=null,City.id=null)},M=function(){return validator_init(f),v=$(d).validate(),$(d).valid()},D=function(){B(),n&&$(n).modal("hide")};return{detail:{formatted_types:"",formatted_address:"",city_id:null,country_id:null,id:null,postal_code:null,province_id:null,street_1:null,street_2:null,street_3:null,address_types_id:[],city_name:null,country_iso2:null,country_iso3:null,country_name:null,province_iso2:null,province_iso3:null,province_name:null,enabled:null,note:null,created_by:null,modified_by:null,date_created:null,date_modified:null},types:new Map,all:new Map,load_modal:function(e){L(e)},format_address:function(e){return E(e)},load:function(e){!function(e){Address.all=new Map,$.each(e,function(e,t){let n=C(t);Address.all.set(Address.detail.id,Address.detail),g.insertRow(n)})}(e)},edit:function(e){!function(e){e&&L(e)}(e)},build_provider_address_table:function(){e&&(g=$(e).table({table_type:"display_list",columnDefs:[{title:"Address",targets:0,data:"street_1",render:function(e,t,n,a){return E(n)}},{title:"Types",targets:1,data:"address_types_id",render:function(e,t,n,a){return h(e)}}],rowClick:Address.edit}))},build_company_address_table:function(){t&&(g=$(t).table({table_type:"display_list",columnDefs:[{title:"Address",targets:0,data:"street_1",render:function(e,t,n,a){return E(n)}},{title:"Types",targets:1,data:"address_types_id",render:function(e,t,n,a){return h(e)}}],rowClick:Address.edit}))},init:function(e){!function(e){Address.types=new Map,e&&e.types&&e.types.address_types&&(Address.types=buildMap(e.types.address_types,"address_types_id")),$(i).BuildDropDown({data:Array.from(Address.types.values()),id_field:"address_types_id",text_field:"address_types_name",type:"multiple",first_selectable:!0}),$(p).BuildDropDown({data:Array.from(Country.all.values()),title:"Country",id_field:"country_id",text_field:"country_name",first_selectable:!1}),$(m).BuildDropDown({data:Array.from(Province.all.values()),title:"Province",id_field:"province_id",text_field:"province_name",first_selectable:!1}),$(u).BuildDropDown({data:Array.from(City.all.values()),title:"City",id_field:"city_id",text_field:"city_name",first_selectable:!1}),Country.init({dropdowns:["address_country_id"]}),Province.init({dropdowns:["address_province_id"]}),City.init({dropdowns:["address_city_id"]})}(e)}}}(),Contact=function(){"use strict";const e=document.getElementById("form_contact_edit"),t=document.getElementById("table_provider_contacts"),n=document.getElementById("table_company_contacts"),a=document.getElementById("modalEditContactForm"),o=(document.getElementById("button_add_provider_contact"),document.getElementById("buttonCancelSaveContactModal")),i=document.getElementById("buttonSaveContactModal"),d=document.getElementById("contact_name_first"),l=document.getElementById("contact_phone"),r=document.getElementById("contact_email"),c=document.getElementById("contact_name_last"),s=document.getElementById("contact_enabled"),u=document.getElementById("contact_id"),_=document.getElementById("contact_types_list");let m,p,y=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;const f={rules:{contact_types_list:{required:!0},contact_name_first:{required:!0},contact_name_last:{required:!0},contact_email:{email:!0}},messages:{contact_types_list:{required:"required"},contact_name_first:{required:"required"},contact_name_last:{required:"required"},contact_email:{email:"invalid"}}};$(i).on("click",function(){I()}),$(o).on("click",function(){E()});const v=function(){return{email:null,id:null,name_first:null,name_last:null,phone:null,contact_types_id:null,enabled:1,created_by:y,modified_by:y,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),note:null}},g=function(e){let t=v();e&&(t={email:e.email?e.email:null,id:validInt(e.id),name_first:e.name_first?e.name_first:null,name_last:e.name_last?e.name_last:null,phone:e.phone?e.phone:null,contact_types_id:getListOfIds(e.contact_types_id),enabled:void 0!==e.enabled?e.enabled:1,created_by:e.created_by?e.created_by:y,modified_by:e.modified_by?e.modified_by:y,date_created:e.date_created?e.date_created:formatDateMySQL(),date_modified:e.date_modified?e.date_modified:formatDateMySQL(),note:e.note?e.note:null}),Contact.detail=t},b=function(e){toastr.error(e),console.log(e)},h=function(e){$(t).DataTable().row("#table_provider_contacts_tr_"+e.id).data(e).draw(!1)},E=function(){v(),a&&$(a).modal("hide")},I=function(){if(validator_init(f),p=validator_init(f),!$(e).valid())return;let t=Contact.all.get(parseInt(u.value));t?t.id=isNaN(parseInt(u.value))?null:parseInt(u.value):t={note:null,date_created:formatDateMySQL(),created_by:y},t.modified_by=y,document.getElementById("company_id")&&""!==document.getElementById("company_id").value&&!isNaN(parseInt(document.getElementById("company_id").value))&&(t.company_id=parseInt(document.getElementById("company_id").value)),t.date_modified=formatDateMySQL(),t.contact_types_id=getListOfIds($(_).val().join(",")),t.enabled=s.checked?1:0,t.name_first=""!==d.value?d.value:null,t.name_last=""!==c.value?c.value:null,t.phone=""!==l.value?l.value:null,t.email=""!==r.value?r.value:null,!0===confirm("Are you sure you want to edit this record?")&&function(e){if(e)try{sendPostRequest("/contacts/update",e,function(t,n,a){t&&t[0]&&(g({contact_types_id:t[0].contact_contact_types_id,created_by:t[0].contact_created_by,date_created:t[0].contact_date_created,date_modified:t[0].contact_date_modified,email:t[0].contact_email,enabled:t[0].contact_enabled,id:t[0].contact_id,modified_by:t[0].contact_modified_by,name_first:t[0].contact_name_first,name_last:t[0].contact_name_last,note:t[0].contact_note,phone:t[0].contact_phone}),e.id?h(e):m.insertRow(Contact.detail),Contact.all.set(t[0].contact_id,Contact.detail),toastr.success("Contact: "+t[0].contact_id+" updated"),E())})}catch(e){console.log(e),b("Error: Validating Contact")}else console.log("Error: Missing Data"),b("Error: Missing Data")}(remove_nulls(t))},w=function(e){d.value="",l.value="",r.value="",c.value="",s.checked=!0,u.value="",$(_).val([]),g(e),d.value=Contact.detail.name_first,l.value=Contact.detail.phone,r.value=Contact.detail.email,c.value=Contact.detail.name_last,s.checked=1===Contact.detail.enabled,u.value=Contact.detail.id,$(_).val(Contact.detail.contact_types_id),a&&$(a).modal("show")};return{detail:{email:null,id:null,name_first:null,name_last:null,phone:null,contact_types_id:null,enabled:null},types:new Map,types_detail:{id:null,name:null,date_created:null,created_by:null,date_modified:null,modified_by:null,enabled:null},all:new Map,save:function(){I()},build_provider_contact_table:function(){t&&(m=$(t).table({table_type:"display_list",columnDefs:[{title:"First Name",targets:0,data:"name_first",render:function(e,t,n,a){return e}},{title:"Last Name",targets:1,data:"name_last",render:function(e,t,n,a){return e}},{title:"Types",targets:2,data:"contact_types_id",render:function(e,t,n,a){let o,i="";return o="string"==typeof e||e instanceof String?e.split(","):e,$.each(o,function(e,t){if(!isNaN(parseInt(t))){let e=Contact.types.get(parseInt(t));e&&(i+="<p class='m-0 mb-1' style='white-space: nowrap'>"+e.contact_types_name.substr(0,7)+"</p>")}}),i}}],rowClick:Contact.edit}))},build_company_contact_table:function(){n&&(m=$(n).table({table_type:"display_list",columnDefs:[{title:"First Name",targets:0,data:"name_first",render:function(e,t,n,a){return e}},{title:"Last Name",targets:1,data:"name_last",render:function(e,t,n,a){return e}},{title:"Types",targets:2,data:"contact_types_id",render:function(e,t,n,a){let o,i="";return o="string"==typeof e||e instanceof String?e.split(","):e,$.each(o,function(e,t){if(!isNaN(parseInt(t))){let e=Contact.types.get(parseInt(t));e&&(i+="<p class='m-0 mb-1' style='white-space: nowrap'>"+e.contact_types_name.substr(0,7)+"</p>")}}),i}}],rowClick:Contact.edit}))},edit:function(e){w(e)},load:function(e){!function(e){Contact.all=new Map,$.each(e,function(e,t){g({contact_types_id:t.contact_contact_types_id,created_by:t.contact_created_by,date_created:t.contact_date_created,date_modified:t.contact_date_modified,email:t.contact_email,enabled:t.contact_enabled,id:t.contact_id,modified_by:t.contact_modified_by,name_first:t.contact_name_first,name_last:t.contact_name_last,note:t.contact_note,phone:t.contact_phone}),Contact.all.set(parseInt(Contact.detail.id),Contact.detail),m.insertRow(Contact.detail)})}(e)},init:function(e){!function(e){Contact.types=new Map,e&&e.types&&e.types.contact_types&&(Contact.types=buildMap(e.types.contact_types,"contact_types_id")),$(_).BuildDropDown({data:Array.from(Contact.types.values()),first_selectable:!0,id_field:"contact_types_id",text_field:"contact_types_name",type:"multiple"})}(e)}}}(),Company=function(){"use strict";const e=document.getElementById("button_save_company_name"),t=document.getElementById("button_edit_company_name"),n=document.getElementById("button_cancel_company_name"),a=document.getElementById("button_submit_form_edit_company"),o=document.getElementById("company_email"),i=document.getElementById("company_website"),d=document.getElementById("company_fax"),l=document.getElementById("company_phone_2"),r=document.getElementById("company_phone_1"),c=document.getElementById("company_enabled"),s=document.getElementById("company_name"),u=document.getElementById("company_id"),_=document.getElementById("form_edit_company");let m=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4,p="",y="",f=!1,v=!1,g=[],b={rules:{company_phone_1:{phoneUS:!1,phoneIT:!1},company_name:{required:!0},company_phone_2:{phoneUS:!1,phoneIT:!1},company_fax:{phoneUS:!1,phoneIT:!1},company_email:{email:!0},company_website:{url:!0}},messages:{company_name:{required:"Field Required"},company_phone_1:{phoneUS:"Field Invalid",phoneIT:"Field Invalid"},company_phone_2:{phoneUS:"Field Invalid",phoneIT:"Field Invalid"},company_fax:{phoneUS:!1,phoneIT:!1},company_email:{email:"Field Invalid"},company_website:{url:"Field Invalid"}}};$(u).on("change",function(){}),$(s).on("click",function(){$(this).select()}).on("keyup",function(){v=!1,C()&&B()}).on("change",function(){setTimeout(function(){let e=s.value;!1===v&&(""===e?(s.value="",u.value="",v=!1):Company.company_exists(e,function(e){console.log("data",e),e?(s.value=e.company_name,u.value=e.company_id,v=!0):(v=!1,I(s))}))},250)}).autocomplete({serviceUrl:"/autocomplete/companies",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){v=!0,Company.set_detail(e.data),u.value=Company.detail.id,s.value=Company.detail.name}}),$(e).on("click",function(){N()}),$(n).on("click",function(){s.value=p,u.value=y,p="",y="",L()}),$(t).on("click",function(){p=s.value,y=u.value,k()}),$(a).on("click",function(){N()});const h=function(){console.log("-- load_form() --"),console.log("-- clear_form() --"),o.value="",i.value="",d.value="",l.value="",r.value="",c.checked=!0,u.value=Company.detail.id,o.value=Company.detail.email,i.value=Company.detail.website,d.value=Company.detail.fax,l.value=Company.detail.phone_2,r.value=Company.detail.phone_1,c.checked=!(Company.detail.enabled&&0===Company.detail.enabled)},E=e=>{let t=$(e.target).parents("div.edit_company_name"),n=$("div.autocomplete-suggestion");t[0]||n||(s.value=p,u.value=y,p="",y="",L())},I=function(e){if(!1===v&&(e.value.length>0&&0===g.length&&!1===v||e.value.length>0&&g.length>0&&!v))if(confirm(e.value+" is not on the list. Would you like to add it to the list?.")){let t={name:e.value};try{sendPostRequest("/companies/update",t,function(e,t,n){console.log(e),e?(u.value=e[0].company_id,s.value=e[0].company_name,x(e[0]),Company.load_name_edit(),Company.unload_name_edit(),toastr.success("Record Added.")):(s.value="",u.value="",toastr.error("Unable to add record."))})}catch(e){toastr.error("Unable to add record."),console.log(e)}}else e.value="",u&&(u.value=""),g=[]},w=function(e){toastr.error(e),console.log(e)},C=function(){return""!==s.value&&!isNaN(parseInt(u.value))},B=function(){$(s).removeClass("is-invalid"),$("#company_name-error").html("")},k=function(){B(),$(e).show(),$(n).show(),$(t).hide(),$(s).attr("readonly",!1),s.disabled=!1,$(s).select(),window.addEventListener("click",E)},L=function(){B(),$(e).hide(),$(n).hide(),$(t).show(),$(s).attr("readonly",!0),s.disabled=!0,window.removeEventListener("click",E)},x=function(e){let t={id:null,name:null,phone_1:null,phone_2:null,fax:null,website:null,email:null,enabled:1,created_by:m,date_created:formatDateMySQL(),modified_by:m,date_modified:formatDateMySQL(),status:6,note:null};e&&(t={id:validInt(e.company_id),name:e.company_name?e.company_name:"",phone_1:e.company_phone_1?e.company_phone_1:"",phone_2:e.company_phone_2?e.company_phone_2:"",fax:e.company_fax?e.company_fax:"",website:e.company_website?e.company_website:"",email:e.company_email?e.company_email:"",enabled:e.company_enabled?e.company_enabled:0,created_by:m,date_created:e.company_date_created?e.company_date_created:formatDateMySQL(),modified_by:m,date_modified:e.company_date_modified?e.company_date_modified:formatDateMySQL(),status:e.company_status?e.company_status:6,note:null}),Company.detail=t},N=function(){f=!0;let e={id:isNaN(parseInt(u.value))?null:parseInt(u.value),name:""!==s.value?s.value:null,phone_1:""!==r.value?r.value:null,phone_2:""!==l.value?l.value:null,fax:""!==d.value?d.value:null,email:""!==o.value?o.value:null,website:""!==i.value?i.value:null,created_by:isNaN(parseInt(u.value))?m:null,modified_by:m,enabled:1,date_created:isNaN(parseInt(u.value))?formatDateMySQL():null,date_modified:formatDateMySQL(),note:null};if(C()){B(),!0===confirm("Are you sure you want to edit this record?")&&function(e,t){if(e)try{sendPostRequest("/companies/update",e,function(e,t,n){if(console.log("update_company_record(): data",e),!e||!e[0])return w("Error: 1");L(),toastr.success("Company: "+e[0].company_id+" updated")})}catch(e){console.log(e),w("Error: Validating Company")}else console.log("Error: Missing Data"),w("Error: Missing Data")}(remove_nulls(e))}else $(s).addClass("is-invalid"),$("#company_name-error").html('<span id="location_name-error" class="error">ssfield required</span>')};return{validator:null,detail:{id:null,created_by:null,modified_by:null,name:null,contact_name:null,contact_phone:null,users_id:null,status:null,enabled:null,date_created:null,date_modified:null,note:null},all:new Map,save:function(){N()},set_detail:function(e){x(e)},unload_name_edit:function(){L()},load_name_edit:function(){k()},company_exists:function(e,t){!function(e,t){if(console.log("globalSelectedCompany",v),!0!==v&&e&&""!==e)try{sendGetRequest("/autocomplete/validate/company",{name:e},function(e,n,a){return console.dir("data",e),e&&e[0]?(v=!0,t(e[0])):t()})}catch(e){return console.log(e),w("Error Validating Company")}}(e,t)},disable_form:function(){_&&(L(),s.disabled=!0,$(s).attr("readonly",!0),c.disabled=!0,r.disabled=!0,l.disabled=!0,d.disabled=!0,o.disabled=!0,i.disabled=!0,a.disabled=!0)},validate_form:function(){return function(){Company.validator=validator_init(b);let e=$(_).valid();return e||console.log(void Company.validator),e}()},enable_form:function(){_&&(s.disabled=!1,c.disabled=!1,r.disabled=!1,l.disabled=!1,d.disabled=!1,o.disabled=!1,i.disabled=!1,a.disabled=!1,$(s).attr("readonly",!1))},init:function(t){Company.validator=validator_init(b),function(t){x(t),h(),k(),t?L():($(e).hide(),$(n).hide())}(t)}}}(),Vendor=function(){"use strict";const e=document.getElementById("provider_vendor_edit_form"),t=document.getElementById("vendor_id"),n=document.getElementById("vendor_enabled"),a=document.getElementById("show_online"),o=document.getElementById("show_sales"),i=document.getElementById("show_ops"),d=document.getElementById("vendor_sku"),l=document.getElementById("button_submit_form_edit_vendor"),r=document.getElementById("table_vendor_index");let c=$(r),s=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;const u={rules:{vendor_sku:{required:!0}},messages:{vendor_sku:{required:"Field Required"}}},_={rules:{vendor_sku:{required:!0}},messages:{vendor_sku:{required:"Field Required"}}};$(l).on("click",function(){Vendor.save()});const m=function(e){let t={id:null,company_id:null,status_id:9,sku:null,show_online:null,show_sales:null,show_ops:null,is_provider:null,phone_1:null,phone_2:null,fax:null,website:null,email:null,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),enabled:1,created_by:s,note:null,modified_by:s};e&&(t.id=e.vendor_id?e.vendor_id:null,t.company_id=e.vendor_company_id?e.vendor_company_id:null,t.status_id=e.vendor_status_id?e.vendor_status_id:9,t.sku=e.vendor_sku?e.vendor_sku:null,t.show_online=e.vendor_show_online?1===e.vendor_show_online?1:0:null,t.show_sales=e.vendor_show_sales?1===e.vendor_show_sales?1:0:null,t.show_ops=e.vendor_show_ops?1===e.vendor_show_ops?1:0:null,t.is_provider=e.vendor_is_provider?e.vendor_is_provider:null,t.phone_1=e.vendor_phone_1?e.vendor_phone_1:null,t.phone_2=e.vendor_phone_2?e.vendor_phone_2:null,t.fax=e.vendor_fax?e.vendor_fax:null,t.website=e.vendor_website?e.vendor_website:null,t.email=e.vendor_email?e.vendor_email:null,t.date_created=e.vendor_date_created?e.vendor_date_created:formatDateMySQL(),t.created_by=e.vendor_created_by?e.vendor_created_by:s,t.date_modified=e.vendor_date_modified?e.vendor_date_modified:formatDateMySQL(),t.modified_by=e.vendor_modified_by?e.vendor_modified_by:s,t.enabled=e.vendor_enabled?e.vendor_enabled:1,t.note=e.vendor_note?e.vendor_note:null),Vendor.detail=t},p=function(e){toastr.error(e),console.log(e)},y=function(){return Vendor.validator=validator_init(_),$(e).valid()},f=function(){t.value="",d.value="",n.checked=!0,a.checked=!0,o.checked=!0,i.checked=!0},v=function(){f(),t.value=Vendor.detail.id,d.value=Vendor.detail.sku,n.checked=1===Vendor.detail.enabled,a.checked=1===Vendor.detail.show_online,o.checked=1===Vendor.detail.show_sales,i.checked=1===Vendor.detail.show_ops},g=function(l){console.log("-- save_provider_vendor(): provider_details:",l);const r=document.getElementById("provider_vendor"),c=document.getElementById("company_id");let u={id:isNaN(parseInt(t.value))?null:parseInt(t.value),company_id:isNaN(parseInt(c.value))?null:parseInt(c.value),status_id:null,sku:d?d.value:null,show_online:a&&a.checked?1:0,show_sales:o&&o.checked?1:0,show_ops:i&&i.checked?1:0,is_provider:r&&r.checked?1:0,date_created:Vendor.detail.date_created?Vendor.detail.date_created:formatDateMySQL(),created_by:Vendor.detail.created_by?Vendor.detail.created_by:s,date_modified:formatDateMySQL(),modified_by:s,enabled:n.checked?1:0,note:Vendor.detail.note?Vendor.detail.note:null};!function(t){if(console.log("-- update_vendor_record(): dataToSend:",t),t)try{sendPostRequest("/vendors/update",t,function(t,n,a){t&&(console.log("-- update_vendor_record(): data:",t),b(t),v(),clear_validation(e),toastr.success("Vendor: "+t.vendor_id+" updated"))})}catch(e){console.log(e),p("Error: Validating Contact")}else console.log("Error: Missing Data"),p("Error: Missing Data")}(remove_nulls(u))},b=function(e){e&&m(e)};return{detail:{id:null,company_id:null,status_id:null,sku:null,show_online:null,show_sales:null,show_ops:null,is_provider:null,phone_1:null,phone_2:null,fax:null,website:null,email:null,date_created:formatDateMySQL(),created_by:s,date_modified:formatDateMySQL(),modified_by:s,enabled:1,note:null},all:new Map,validator:null,save:function(){!function(){if(!y())return;let e=Contact.all.get(parseInt(_modal_contact_id.value));e?e.id=isNaN(parseInt(_modal_contact_id.value))?null:parseInt(_modal_contact_id.value):e={note:null,date_created:formatDateMySQL(),created_by:s},e.modified_by=s,document.getElementById("provider_id")&&""!==document.getElementById("provider_id").value&&!isNaN(parseInt(document.getElementById("provider_id").value))&&(e.provider_id=parseInt(document.getElementById("provider_id").value)),document.getElementById("vendor_id")&&""!==document.getElementById("vendor_id").value&&!isNaN(parseInt(document.getElementById("vendor_id").value))&&(e.vendor_id=parseInt(document.getElementById("vendor_id").value)),e.date_modified=formatDateMySQL(),e.contact_types_id=getListOfIds($(_modal_contact_types_list).val().join(",")),e.enabled=_modal_contact_enabled.checked?1:0,e.name_first=""!==_modal_contact_name_first.value?_modal_contact_name_first.value:null,e.name_last=""!==_modal_contact_name_last.value?_modal_contact_name_last.value:null,e.phone=""!==_modal_contact_phone.value?_modal_contact_phone.value:null,e.email=""!==_modal_contact_email.value?_modal_contact_email.value:null;confirm("Are you sure you want to edit this record?")}()},save_provider_vendor:function(e){g(e)},edit:function(e){},load:function(e){b(e)},init:function(e){!function(e){b(e)}(e)},init_provider_vendor:function(e){},populate_provider_vendor_form:function(){v()},validate_provider_vendor:function(){return Vendor.validator=validator_init(u),$(e).valid()},validate_form:function(){return y()},clear_provider_vendor_form:function(){f()},navigate:function(e){!function(e){e&&console.log(e)}(e)},index:function(e){!function(e){Vendor.all=new Map,e&&e.vendor_list&&$.each(e.vendor_list,function(e,t){m(t),Vendor.all.set(Vendor.detail.id,Vendor.detail),console.log(Vendor.detail)}),r&&(c=$(r).table({table_type:"display_list",data:Array.from(Vendor.all.values()),columnDefs:[{title:"Id",targets:0,data:"id"},{title:"Name",targets:1,data:"company_id",render:function(e,t,n,a){return e}},{title:"Is Provider",targets:2,data:"is_provider",render:function(e,t,n,a){return e&&1===e?"<span class='text-success'>Yes</span>":"<span class='text-warning'>No</span>"}}],rowClick:Vendor.navigate}))}(e)}}}();